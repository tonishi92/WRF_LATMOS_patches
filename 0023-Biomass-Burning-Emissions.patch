From 90dd29eef0bcde1a62bdda8be5701b8d6bd93ecc Mon Sep 17 00:00:00 2001
From: Tatsuo ONISHI <onishi@latmos.ipsl.fr>
Date: Wed, 5 Oct 2022 12:55:57 +0200
Subject: [PATCH 23/49] Biomass Burning Emissions

Add a biomass emissions packages for CBMZ and SAPRC
Add a namelist switch "ifplumerise" to turn on and off plume rise
Change a variable name from 'sum' to 'sum_fires' to avoid confusion with FORTRAN function 'sum'
Add biomass burning emission packages for CBMZ (namelist option 14) and SAPRC (namelist option 6)

TYPE : Enhancement
Source : Louis Marelle

list of modified files:
---------------------------------------------------------------------------------
chem/emissions_driver.F
    * Set do_plumerisefire = .true. for biomass burning emission packages for SAPRC
      biomass_burn_opt == BIOMASSB_SAPRC and CBMZ biomass_burn_opt == BIOMASSB_CBMZ
    * Add biomass burning emission packages for SAPRC and CBMZ :
      pass alt to subroutine add_emis_burn in chem/module_add_emiss_burn.F

chem/module_add_emiss_burn.F
    * Add CBMZ to emiss_select, this correponds to biomass_burn_opt = BIOMASSB_CBMZ
    * Add SAPRC99 to emiss_select, this correspond to biomass_burn_opt = BIOMASSB_SAPRC.
      For this, conv3 local variable is used and alt is passed in to subroutine add_emis_burn.

chem/module_plumerise1.F
    * Implementation of a switch ifplumerise to activate/deactivate plume rise
      It is now in namelist. See Registry/registry.chem.
    * Rename sum to sum_fires to avoid the use of otherwise reserved name sum.
    * Implementation of biomass burning emission package for SAPRC biomass_burn_opt = BIOMASSB_SAPRC(6).
      Concerned species are
          co, no, no2, so2, nh3, ch4, acet, c2h6, c3h8, alk3, alk4, alk5,
          aro1, aro2, bald, ccho, cco_oh, ethene,hcho, hcooh, hono, isoprene,
          mek, meoh, methacro, mgly, mvk, ole1, ole2, phen, prod2, rcho, rno3, terp,
          pm10, pm25, oc, bc
    * Implemantation of biomass burning emission package for CBMZ biomass_burn_opt = BIOMASSB_CBMZ(4).
      Concerned species are
          no, co, c2h4, c2h5oh, c2h6, c3h6, c3h8, ch2o, ch3cho, ch3coch3, ch3oh,
          mek, so2, toluene, nh3, no2, open, h10h16, mgly, ch3cooh, glyald, gly,
          acetol, isop, marc, mvk, ol2, par, eth, olt, oli, iso, tol, csl, hcho,
          ald, ket, xyl, ora1, ora2, co2, ete, dien, api, lim, pm10, pm25, oc, bc

Registry/registry.chem
    * Implementation of additional arrays ebu_XXX for SAPRC biomass burning
    * Implementation of additional arrays ebu_XXX for CBMZ-MOSAIC biomass burning
    * Implementation of additional arrays ebu_in_XXX for SAPRC biomass burning
    * Implementation of additional arrays ebu_in_XXX for CBMZ-MOSAIC biomass burning
    * Implementation of biomass_burn_opt==14 : biomassb_cbmz  (Formerly 4, which is now used for biomassb_t1_mozcart)
    * Implementation of biomass_burn_opt==6  : biomassb_saprc
---
 Registry/registry.chem       |  22 ++++
 chem/emissions_driver.F      |  14 ++-
 chem/module_add_emiss_burn.F |  46 +++++++++
 chem/module_plumerise1.F     | 192 +++++++++++++++++++++++++----------
 4 files changed, 217 insertions(+), 57 deletions(-)

diff --git a/Registry/registry.chem b/Registry/registry.chem
index dc00f8ca..30de3b69 100644
--- a/Registry/registry.chem
+++ b/Registry/registry.chem
@@ -442,6 +442,10 @@ state    real  ebu_terp     ikjf     ebu           1         Z        -      "eb
 # CH4 biomass burning emissions
 state    real  ebu_ch4      ikjf     ebu           1         Z        h      "ebu_ch4"       "biomass burning emiss"  "mol km^-2 hr^-1"
 
+# jcr : Additional arrays for CBMZ-MOSAIC biomass burning
+state    real  ebu_ol2      ikjf     ebu           1         Z        -      "ebu_ol2"       "biomass burning emiss"  "mol km^-2 hr^-1"
+state    real  ebu_par      ikjf     ebu           1         Z        -      "ebu_par"       "biomass burning emiss"  "mol km^-2 hr^-1"
+
 # additional arrays needed for biomass burning emissions input
 state    real     -               i]jf      ebu_in      -         -        -         -                    "Biomass burnung input "         ""
 state    real  ebu_in_no          i]jf      ebu_in      1         -        i07        "ebu_in_no"             "EMISSIONS"          "mol km^-2 hr^-1"
@@ -536,6 +540,10 @@ state    real  ebu_in_terp        iljf     ebu_in       1         -        i07
 # additional array for ch4 bbm emission
 state    real  ebu_in_ch4         i]jf      ebu_in      1         -        i07        "ebu_in_ch4"        "EMISSIONS"          "mol km^-2 hr^-1"
 #
+# jcr : Additional arrays for CBMZ-MOSAIC biomass burning
+state    real  ebu_in_ol2         i]jf      ebu_in      1         -        i07        "ebu_in_ol2"        "EMISSIONS"          "mol km^-2 hr^-1"
+state    real  ebu_in_par         i]jf      ebu_in      1         -        i07        "ebu_in_par"        "EMISSIONS"          "mol km^-2 hr^-1"
+
 state    real  mean_fct_agtf      ij      misc      1         -        i07h       "mean_fct_agtf"         "mean fraction of tropical forest"  "?"
 state    real  mean_fct_agef      ij      misc      1         -        i07h       "mean_fct_agef"         "mean fraction of extra tropical forest"  "?"
 state    real  mean_fct_agsv      ij      misc      1         -        i07h       "mean_fct_agsv"         "mean fraction of savanna"  "?"
@@ -4114,6 +4122,9 @@ rconfig   integer     seas_updates        namelist,chem          max_domains
 rconfig   integer     bio_emiss_opt       namelist,chem          max_domains    0       rh    "bio_emiss_opt"       ""      ""
 rconfig   integer     biomass_burn_opt    namelist,chem          max_domains    0       rh    "biomass_burn_opt"    ""      ""
 rconfig   integer     plumerisefire_frq   namelist,chem          max_domains    180     rh    "plumerisefire_frq"   ""      ""
+#LI:TO2
+rconfig   integer     ifplumerise         namelist,chem          max_domains    1       rh    "ifplumerise"         ""      ""
+#LI:TO2
 rconfig   integer     emiss_inpt_opt      namelist,chem          max_domains    1       rh    "emiss_inpt_opt"      ""      ""
 rconfig   integer     gas_bc_opt          namelist,chem          max_domains    1       rh    "gas_bc_opt"          ""      ""
 rconfig   integer     gas_ic_opt          namelist,chem          max_domains    1       rh    "gas_ic_opt"          ""      ""
@@ -4260,12 +4271,22 @@ package   cb05_sorg_vbs_aq_kpp          chem_opt==132                 -
 #cbmz_mosaic_kpp (chem_opt=170) is for mosaic runs with sorgam soa species: coded by Manish Shrivastava on 12/8/2009
 package   cbmz_mosaic_kpp chem_opt==170               -             chem:so2,sulf,no2,no,o3,hno3,h2o2,ald,hcho,op1,op2,ora1,ora2,nh3,n2o5,no3,pan,eth,co,ol2,olt,oli,tol,xyl,hono,hno4,ket,mgly,onit,csl,iso,ho,ho2,hcl,ch3o2,ethp,ch3oh,c2h5oh,par,to2,cro,open,op3,c2o3,ro2,ano2,nap,xo2,xpar,isoprd,isopp,isopn,ch4,aro1,aro2,alk1,ole1,api1,api2,lim1,lim2,api,lim,isopo2,so4_a01,no3_a01,cl_a01,nh4_a01,na_a01,oin_a01,oc_a01,bc_a01,hysw_a01,water_a01,aro1_a01,aro2_a01,alk1_a01,ole1_a01,api1_a01,api2_a01,lim1_a01,lim2_a01,num_a01,so4_a02,no3_a02,cl_a02,nh4_a02,na_a02,oin_a02,oc_a02,bc_a02,hysw_a02,water_a02,aro1_a02,aro2_a02,alk1_a02,ole1_a02,api1_a02,api2_a02,lim1_a02,lim2_a02,num_a02,so4_a03,no3_a03,cl_a03,nh4_a03,na_a03,oin_a03,oc_a03,bc_a03,hysw_a03,water_a03,aro1_a03,aro2_a03,alk1_a03,ole1_a03,api1_a03,api2_a03,lim1_a03,lim2_a03,num_a03,so4_a04,no3_a04,cl_a04,nh4_a04,na_a04,oin_a04,oc_a04,bc_a04,hysw_a04,water_a04,aro1_a04,aro2_a04,alk1_a04,ole1_a04,api1_a04,api2_a04,lim1_a04,lim2_a04,num_a04,so4_a05,no3_a05,cl_a05,nh4_a05,na_a05,oin_a05,oc_a05,bc_a05,hysw_a05,water_a05,aro1_a05,aro2_a05,alk1_a05,ole1_a05,api1_a05,api2_a05,lim1_a05,lim2_a05,num_a05,so4_a06,no3_a06,cl_a06,nh4_a06,na_a06,oin_a06,oc_a06,bc_a06,hysw_a06,water_a06,aro1_a06,aro2_a06,alk1_a06,ole1_a06,api1_a06,api2_a06,lim1_a06,lim2_a06,num_a06,so4_a07,no3_a07,cl_a07,nh4_a07,na_a07,oin_a07,oc_a07,bc_a07,hysw_a07,water_a07,aro1_a07,aro2_a07,alk1_a07,ole1_a07,api1_a07,api2_a07,lim1_a07,lim2_a07,num_a07,so4_a08,no3_a08,cl_a08,nh4_a08,na_a08,oin_a08,oc_a08,bc_a08,hysw_a08,water_a08,aro1_a08,aro2_a08,alk1_a08,ole1_a08,api1_a08,api2_a08,lim1_a08,lim2_a08,num_a08,ca_a01,ca_a02,ca_a03,ca_a04,ca_a05,ca_a06,ca_a07,ca_a08,co3_a01,co3_a02,co3_a03,co3_a04,co3_a05,co3_a06,co3_a07,co3_a08
 
+package   cbmz_mosaic_8bin_vbs9_kpp chem_opt==190               -             chem:so2,sulf,no2,no,o3,hno3,h2o2,ald,hcho,op1,op2,ora1,ora2,nh3,n2o5,no3,pan,eth,co,ol2,olt,oli,tol,xyl,hono,hno4,ket,mgly,onit,csl,iso,ho,ho2,hcl,ch3o2,ethp,ch3oh,c2h5oh,par,to2,cro,open,op3,c2o3,ro2,ano2,nap,xo2,xpar,isoprd,isopp,isopn,ch4,aro1,aro2,alk1,ole1,api1,api2,lim1,lim2,api,lim,pcg1_b_c,pcg2_b_c,pcg3_b_c,pcg4_b_c,pcg5_b_c,pcg6_b_c,pcg7_b_c,pcg8_b_c,pcg9_b_c,pcg1_b_o,pcg2_b_o,pcg3_b_o,pcg4_b_o,pcg5_b_o,pcg6_b_o,pcg7_b_o,pcg8_b_o,pcg9_b_o,opcg1_b_c,opcg2_b_c,opcg3_b_c,opcg4_b_c,opcg5_b_c,opcg6_b_c,opcg7_b_c,opcg8_b_c,opcg1_b_o,opcg2_b_o,opcg3_b_o,opcg4_b_o,opcg5_b_o,opcg6_b_o,opcg7_b_o,opcg8_b_o,pcg1_f_c,pcg2_f_c,pcg3_f_c,pcg4_f_c,pcg5_f_c,pcg6_f_c,pcg7_f_c,pcg8_f_c,pcg9_f_c,pcg1_f_o,pcg2_f_o,pcg3_f_o,pcg4_f_o,pcg5_f_o,pcg6_f_o,pcg7_f_o,pcg8_f_o,pcg9_f_o,opcg1_f_c,opcg2_f_c,opcg3_f_c,opcg4_f_c,opcg5_f_c,opcg6_f_c,opcg7_f_c,opcg8_f_c,opcg1_f_o,opcg2_f_o,opcg3_f_o,opcg4_f_o,opcg5_f_o,opcg6_f_o,opcg7_f_o,opcg8_f_o,psd1,psd2,isopo2,so4_a01,no3_a01,cl_a01,nh4_a01,na_a01,oin_a01,oc_a01,bc_a01,hysw_a01,water_a01,aro1_a01,aro2_a01,alk1_a01,ole1_a01,api1_a01,api2_a01,lim1_a01,lim2_a01,pcg1_b_c_a01,pcg2_b_c_a01,pcg3_b_c_a01,pcg4_b_c_a01,pcg5_b_c_a01,pcg6_b_c_a01,pcg7_b_c_a01,pcg8_b_c_a01,pcg9_b_c_a01,pcg1_b_o_a01,pcg2_b_o_a01,pcg3_b_o_a01,pcg4_b_o_a01,pcg5_b_o_a01,pcg6_b_o_a01,pcg7_b_o_a01,pcg8_b_o_a01,pcg9_b_o_a01,opcg1_b_c_a01,opcg2_b_c_a01,opcg3_b_c_a01,opcg4_b_c_a01,opcg5_b_c_a01,opcg6_b_c_a01,opcg7_b_c_a01,opcg8_b_c_a01,opcg1_b_o_a01,opcg2_b_o_a01,opcg3_b_o_a01,opcg4_b_o_a01,opcg5_b_o_a01,opcg6_b_o_a01,opcg7_b_o_a01,opcg8_b_o_a01,pcg1_f_c_a01,pcg2_f_c_a01,pcg3_f_c_a01,pcg4_f_c_a01,pcg5_f_c_a01,pcg6_f_c_a01,pcg7_f_c_a01,pcg8_f_c_a01,pcg9_f_c_a01,pcg1_f_o_a01,pcg2_f_o_a01,pcg3_f_o_a01,pcg4_f_o_a01,pcg5_f_o_a01,pcg6_f_o_a01,pcg7_f_o_a01,pcg8_f_o_a01,pcg9_f_o_a01,opcg1_f_c_a01,opcg2_f_c_a01,opcg3_f_c_a01,opcg4_f_c_a01,opcg5_f_c_a01,opcg6_f_c_a01,opcg7_f_c_a01,opcg8_f_c_a01,opcg1_f_o_a01,opcg2_f_o_a01,opcg3_f_o_a01,opcg4_f_o_a01,opcg5_f_o_a01,opcg6_f_o_a01,opcg7_f_o_a01,opcg8_f_o_a01,num_a01,so4_a02,no3_a02,cl_a02,nh4_a02,na_a02,oin_a02,oc_a02,bc_a02,hysw_a02,water_a02,aro1_a02,aro2_a02,alk1_a02,ole1_a02,api1_a02,api2_a02,lim1_a02,lim2_a02,pcg1_b_c_a02,pcg2_b_c_a02,pcg3_b_c_a02,pcg4_b_c_a02,pcg5_b_c_a02,pcg6_b_c_a02,pcg7_b_c_a02,pcg8_b_c_a02,pcg9_b_c_a02,pcg1_b_o_a02,pcg2_b_o_a02,pcg3_b_o_a02,pcg4_b_o_a02,pcg5_b_o_a02,pcg6_b_o_a02,pcg7_b_o_a02,pcg8_b_o_a02,pcg9_b_o_a02,opcg1_b_c_a02,opcg2_b_c_a02,opcg3_b_c_a02,opcg4_b_c_a02,opcg5_b_c_a02,opcg6_b_c_a02,opcg7_b_c_a02,opcg8_b_c_a02,opcg1_b_o_a02,opcg2_b_o_a02,opcg3_b_o_a02,opcg4_b_o_a02,opcg5_b_o_a02,opcg6_b_o_a02,opcg7_b_o_a02,opcg8_b_o_a02,pcg1_f_c_a02,pcg2_f_c_a02,pcg3_f_c_a02,pcg4_f_c_a02,pcg5_f_c_a02,pcg6_f_c_a02,pcg7_f_c_a02,pcg8_f_c_a02,pcg9_f_c_a02,pcg1_f_o_a02,pcg2_f_o_a02,pcg3_f_o_a02,pcg4_f_o_a02,pcg5_f_o_a02,pcg6_f_o_a02,pcg7_f_o_a02,pcg8_f_o_a02,pcg9_f_o_a02,opcg1_f_c_a02,opcg2_f_c_a02,opcg3_f_c_a02,opcg4_f_c_a02,opcg5_f_c_a02,opcg6_f_c_a02,opcg7_f_c_a02,opcg8_f_c_a02,opcg1_f_o_a02,opcg2_f_o_a02,opcg3_f_o_a02,opcg4_f_o_a02,opcg5_f_o_a02,opcg6_f_o_a02,opcg7_f_o_a02,opcg8_f_o_a02,num_a02,so4_a03,no3_a03,cl_a03,nh4_a03,na_a03,oin_a03,oc_a03,bc_a03,hysw_a03,water_a03,aro1_a03,aro2_a03,alk1_a03,ole1_a03,api1_a03,api2_a03,lim1_a03,lim2_a03,pcg1_b_c_a03,pcg2_b_c_a03,pcg3_b_c_a03,pcg4_b_c_a03,pcg5_b_c_a03,pcg6_b_c_a03,pcg7_b_c_a03,pcg8_b_c_a03,pcg9_b_c_a03,pcg1_b_o_a03,pcg2_b_o_a03,pcg3_b_o_a03,pcg4_b_o_a03,pcg5_b_o_a03,pcg6_b_o_a03,pcg7_b_o_a03,pcg8_b_o_a03,pcg9_b_o_a03,opcg1_b_c_a03,opcg2_b_c_a03,opcg3_b_c_a03,opcg4_b_c_a03,opcg5_b_c_a03,opcg6_b_c_a03,opcg7_b_c_a03,opcg8_b_c_a03,opcg1_b_o_a03,opcg2_b_o_a03,opcg3_b_o_a03,opcg4_b_o_a03,opcg5_b_o_a03,opcg6_b_o_a03,opcg7_b_o_a03,opcg8_b_o_a03,pcg1_f_c_a03,pcg2_f_c_a03,pcg3_f_c_a03,pcg4_f_c_a03,pcg5_f_c_a03,pcg6_f_c_a03,pcg7_f_c_a03,pcg8_f_c_a03,pcg9_f_c_a03,pcg1_f_o_a03,pcg2_f_o_a03,pcg3_f_o_a03,pcg4_f_o_a03,pcg5_f_o_a03,pcg6_f_o_a03,pcg7_f_o_a03,pcg8_f_o_a03,pcg9_f_o_a03,opcg1_f_c_a03,opcg2_f_c_a03,opcg3_f_c_a03,opcg4_f_c_a03,opcg5_f_c_a03,opcg6_f_c_a03,opcg7_f_c_a03,opcg8_f_c_a03,opcg1_f_o_a03,opcg2_f_o_a03,opcg3_f_o_a03,opcg4_f_o_a03,opcg5_f_o_a03,opcg6_f_o_a03,opcg7_f_o_a03,opcg8_f_o_a03,num_a03,so4_a04,no3_a04,cl_a04,nh4_a04,na_a04,oin_a04,oc_a04,bc_a04,hysw_a04,water_a04,aro1_a04,aro2_a04,alk1_a04,ole1_a04,api1_a04,api2_a04,lim1_a04,lim2_a04,pcg1_b_c_a04,pcg2_b_c_a04,pcg3_b_c_a04,pcg4_b_c_a04,pcg5_b_c_a04,pcg6_b_c_a04,pcg7_b_c_a04,pcg8_b_c_a04,pcg9_b_c_a04,pcg1_b_o_a04,pcg2_b_o_a04,pcg3_b_o_a04,pcg4_b_o_a04,pcg5_b_o_a04,pcg6_b_o_a04,pcg7_b_o_a04,pcg8_b_o_a04,pcg9_b_o_a04,opcg1_b_c_a04,opcg2_b_c_a04,opcg3_b_c_a04,opcg4_b_c_a04,opcg5_b_c_a04,opcg6_b_c_a04,opcg7_b_c_a04,opcg8_b_c_a04,opcg1_b_o_a04,opcg2_b_o_a04,opcg3_b_o_a04,opcg4_b_o_a04,opcg5_b_o_a04,opcg6_b_o_a04,opcg7_b_o_a04,opcg8_b_o_a04,pcg1_f_c_a04,pcg2_f_c_a04,pcg3_f_c_a04,pcg4_f_c_a04,pcg5_f_c_a04,pcg6_f_c_a04,pcg7_f_c_a04,pcg8_f_c_a04,pcg9_f_c_a04,pcg1_f_o_a04,pcg2_f_o_a04,pcg3_f_o_a04,pcg4_f_o_a04,pcg5_f_o_a04,pcg6_f_o_a04,pcg7_f_o_a04,pcg8_f_o_a04,pcg9_f_o_a04,opcg1_f_c_a04,opcg2_f_c_a04,opcg3_f_c_a04,opcg4_f_c_a04,opcg5_f_c_a04,opcg6_f_c_a04,opcg7_f_c_a04,opcg8_f_c_a04,opcg1_f_o_a04,opcg2_f_o_a04,opcg3_f_o_a04,opcg4_f_o_a04,opcg5_f_o_a04,opcg6_f_o_a04,opcg7_f_o_a04,opcg8_f_o_a04,num_a04,so4_a05,no3_a05,cl_a05,nh4_a05,na_a05,oin_a05,oc_a05,bc_a05,hysw_a05,water_a05,aro1_a05,aro2_a05,alk1_a05,ole1_a05,api1_a05,api2_a05,lim1_a05,lim2_a05,pcg1_b_c_a05,pcg2_b_c_a05,pcg3_b_c_a05,pcg4_b_c_a05,pcg5_b_c_a05,pcg6_b_c_a05,pcg7_b_c_a05,pcg8_b_c_a05,pcg9_b_c_a05,pcg1_b_o_a05,pcg2_b_o_a05,pcg3_b_o_a05,pcg4_b_o_a05,pcg5_b_o_a05,pcg6_b_o_a05,pcg7_b_o_a05,pcg8_b_o_a05,pcg9_b_o_a05,opcg1_b_c_a05,opcg2_b_c_a05,opcg3_b_c_a05,opcg4_b_c_a05,opcg5_b_c_a05,opcg6_b_c_a05,opcg7_b_c_a05,opcg8_b_c_a05,opcg1_b_o_a05,opcg2_b_o_a05,opcg3_b_o_a05,opcg4_b_o_a05,opcg5_b_o_a05,opcg6_b_o_a05,opcg7_b_o_a05,opcg8_b_o_a05,pcg1_f_c_a05,pcg2_f_c_a05,pcg3_f_c_a05,pcg4_f_c_a05,pcg5_f_c_a05,pcg6_f_c_a05,pcg7_f_c_a05,pcg8_f_c_a05,pcg9_f_c_a05,pcg1_f_o_a05,pcg2_f_o_a05,pcg3_f_o_a05,pcg4_f_o_a05,pcg5_f_o_a05,pcg6_f_o_a05,pcg7_f_o_a05,pcg8_f_o_a05,pcg9_f_o_a05,opcg1_f_c_a05,opcg2_f_c_a05,opcg3_f_c_a05,opcg4_f_c_a05,opcg5_f_c_a05,opcg6_f_c_a05,opcg7_f_c_a05,opcg8_f_c_a05,opcg1_f_o_a05,opcg2_f_o_a05,opcg3_f_o_a05,opcg4_f_o_a05,opcg5_f_o_a05,opcg6_f_o_a05,opcg7_f_o_a05,opcg8_f_o_a05,num_a05,so4_a06,no3_a06,cl_a06,nh4_a06,na_a06,oin_a06,oc_a06,bc_a06,hysw_a06,water_a06,aro1_a06,aro2_a06,alk1_a06,ole1_a06,api1_a06,api2_a06,lim1_a06,lim2_a06,pcg1_b_c_a06,pcg2_b_c_a06,pcg3_b_c_a06,pcg4_b_c_a06,pcg5_b_c_a06,pcg6_b_c_a06,pcg7_b_c_a06,pcg8_b_c_a06,pcg9_b_c_a06,pcg1_b_o_a06,pcg2_b_o_a06,pcg3_b_o_a06,pcg4_b_o_a06,pcg5_b_o_a06,pcg6_b_o_a06,pcg7_b_o_a06,pcg8_b_o_a06,pcg9_b_o_a06,opcg1_b_c_a06,opcg2_b_c_a06,opcg3_b_c_a06,opcg4_b_c_a06,opcg5_b_c_a06,opcg6_b_c_a06,opcg7_b_c_a06,opcg8_b_c_a06,opcg1_b_o_a06,opcg2_b_o_a06,opcg3_b_o_a06,opcg4_b_o_a06,opcg5_b_o_a06,opcg6_b_o_a06,opcg7_b_o_a06,opcg8_b_o_a06,pcg1_f_c_a06,pcg2_f_c_a06,pcg3_f_c_a06,pcg4_f_c_a06,pcg5_f_c_a06,pcg6_f_c_a06,pcg7_f_c_a06,pcg8_f_c_a06,pcg9_f_c_a06,pcg1_f_o_a06,pcg2_f_o_a06,pcg3_f_o_a06,pcg4_f_o_a06,pcg5_f_o_a06,pcg6_f_o_a06,pcg7_f_o_a06,pcg8_f_o_a06,pcg9_f_o_a06,opcg1_f_c_a06,opcg2_f_c_a06,opcg3_f_c_a06,opcg4_f_c_a06,opcg5_f_c_a06,opcg6_f_c_a06,opcg7_f_c_a06,opcg8_f_c_a06,opcg1_f_o_a06,opcg2_f_o_a06,opcg3_f_o_a06,opcg4_f_o_a06,opcg5_f_o_a06,opcg6_f_o_a06,opcg7_f_o_a06,opcg8_f_o_a06,num_a06,so4_a07,no3_a07,cl_a07,nh4_a07,na_a07,oin_a07,oc_a07,bc_a07,hysw_a07,water_a07,aro1_a07,aro2_a07,alk1_a07,ole1_a07,api1_a07,api2_a07,lim1_a07,lim2_a07,pcg1_b_c_a07,pcg2_b_c_a07,pcg3_b_c_a07,pcg4_b_c_a07,pcg5_b_c_a07,pcg6_b_c_a07,pcg7_b_c_a07,pcg8_b_c_a07,pcg9_b_c_a07,pcg1_b_o_a07,pcg2_b_o_a07,pcg3_b_o_a07,pcg4_b_o_a07,pcg5_b_o_a07,pcg6_b_o_a07,pcg7_b_o_a07,pcg8_b_o_a07,pcg9_b_o_a07,opcg1_b_c_a07,opcg2_b_c_a07,opcg3_b_c_a07,opcg4_b_c_a07,opcg5_b_c_a07,opcg6_b_c_a07,opcg7_b_c_a07,opcg8_b_c_a07,opcg1_b_o_a07,opcg2_b_o_a07,opcg3_b_o_a07,opcg4_b_o_a07,opcg5_b_o_a07,opcg6_b_o_a07,opcg7_b_o_a07,opcg8_b_o_a07,pcg1_f_c_a07,pcg2_f_c_a07,pcg3_f_c_a07,pcg4_f_c_a07,pcg5_f_c_a07,pcg6_f_c_a07,pcg7_f_c_a07,pcg8_f_c_a07,pcg9_f_c_a07,pcg1_f_o_a07,pcg2_f_o_a07,pcg3_f_o_a07,pcg4_f_o_a07,pcg5_f_o_a07,pcg6_f_o_a07,pcg7_f_o_a07,pcg8_f_o_a07,pcg9_f_o_a07,opcg1_f_c_a07,opcg2_f_c_a07,opcg3_f_c_a07,opcg4_f_c_a07,opcg5_f_c_a07,opcg6_f_c_a07,opcg7_f_c_a07,opcg8_f_c_a07,opcg1_f_o_a07,opcg2_f_o_a07,opcg3_f_o_a07,opcg4_f_o_a07,opcg5_f_o_a07,opcg6_f_o_a07,opcg7_f_o_a07,opcg8_f_o_a07,num_a07,so4_a08,no3_a08,cl_a08,nh4_a08,na_a08,oin_a08,oc_a08,bc_a08,hysw_a08,water_a08,aro1_a08,aro2_a08,alk1_a08,ole1_a08,api1_a08,api2_a08,lim1_a08,lim2_a08,pcg1_b_c_a08,pcg2_b_c_a08,pcg3_b_c_a08,pcg4_b_c_a08,pcg5_b_c_a08,pcg6_b_c_a08,pcg7_b_c_a08,pcg8_b_c_a08,pcg9_b_c_a08,pcg1_b_o_a08,pcg2_b_o_a08,pcg3_b_o_a08,pcg4_b_o_a08,pcg5_b_o_a08,pcg6_b_o_a08,pcg7_b_o_a08,pcg8_b_o_a08,pcg9_b_o_a08,opcg1_b_c_a08,opcg2_b_c_a08,opcg3_b_c_a08,opcg4_b_c_a08,opcg5_b_c_a08,opcg6_b_c_a08,opcg7_b_c_a08,opcg8_b_c_a08,opcg1_b_o_a08,opcg2_b_o_a08,opcg3_b_o_a08,opcg4_b_o_a08,opcg5_b_o_a08,opcg6_b_o_a08,opcg7_b_o_a08,opcg8_b_o_a08,pcg1_f_c_a08,pcg2_f_c_a08,pcg3_f_c_a08,pcg4_f_c_a08,pcg5_f_c_a08,pcg6_f_c_a08,pcg7_f_c_a08,pcg8_f_c_a08,pcg9_f_c_a08,pcg1_f_o_a08,pcg2_f_o_a08,pcg3_f_o_a08,pcg4_f_o_a08,pcg5_f_o_a08,pcg6_f_o_a08,pcg7_f_o_a08,pcg8_f_o_a08,pcg9_f_o_a08,opcg1_f_c_a08,opcg2_f_c_a08,opcg3_f_c_a08,opcg4_f_c_a08,opcg5_f_c_a08,opcg6_f_c_a08,opcg7_f_c_a08,opcg8_f_c_a08,opcg1_f_o_a08,opcg2_f_o_a08,opcg3_f_o_a08,opcg4_f_o_a08,opcg5_f_o_a08,opcg6_f_o_a08,opcg7_f_o_a08,opcg8_f_o_a08,num_a08,ca_a01,ca_a02,ca_a03,ca_a04,ca_a05,ca_a06,ca_a07,ca_a08,co3_a01,co3_a02,co3_a03,co3_a04,co3_a05,co3_a06,co3_a07,co3_a08
+
+
+package   cbmz_mosaic_4bin_vbs9_kpp chem_opt==191               -             chem:so2,sulf,no2,no,o3,hno3,h2o2,ald,hcho,op1,op2,ora1,ora2,nh3,n2o5,no3,pan,eth,co,ol2,olt,oli,tol,xyl,hono,hno4,ket,mgly,onit,csl,iso,ho,ho2,hcl,ch3o2,ethp,ch3oh,c2h5oh,par,to2,cro,open,op3,c2o3,ro2,ano2,nap,xo2,xpar,isoprd,isopp,isopn,ch4,aro1,aro2,alk1,ole1,api1,api2,lim1,lim2,api,lim,pcg1_b_c,pcg2_b_c,pcg3_b_c,pcg4_b_c,pcg5_b_c,pcg6_b_c,pcg7_b_c,pcg8_b_c,pcg9_b_c,pcg1_b_o,pcg2_b_o,pcg3_b_o,pcg4_b_o,pcg5_b_o,pcg6_b_o,pcg7_b_o,pcg8_b_o,pcg9_b_o,opcg1_b_c,opcg2_b_c,opcg3_b_c,opcg4_b_c,opcg5_b_c,opcg6_b_c,opcg7_b_c,opcg8_b_c,opcg1_b_o,opcg2_b_o,opcg3_b_o,opcg4_b_o,opcg5_b_o,opcg6_b_o,opcg7_b_o,opcg8_b_o,pcg1_f_c,pcg2_f_c,pcg3_f_c,pcg4_f_c,pcg5_f_c,pcg6_f_c,pcg7_f_c,pcg8_f_c,pcg9_f_c,pcg1_f_o,pcg2_f_o,pcg3_f_o,pcg4_f_o,pcg5_f_o,pcg6_f_o,pcg7_f_o,pcg8_f_o,pcg9_f_o,opcg1_f_c,opcg2_f_c,opcg3_f_c,opcg4_f_c,opcg5_f_c,opcg6_f_c,opcg7_f_c,opcg8_f_c,opcg1_f_o,opcg2_f_o,opcg3_f_o,opcg4_f_o,opcg5_f_o,opcg6_f_o,opcg7_f_o,opcg8_f_o,psd1,psd2,isopo2,so4_a01,no3_a01,cl_a01,nh4_a01,na_a01,oin_a01,oc_a01,bc_a01,hysw_a01,water_a01,aro1_a01,aro2_a01,alk1_a01,ole1_a01,api1_a01,api2_a01,lim1_a01,lim2_a01,pcg1_b_c_a01,pcg2_b_c_a01,pcg3_b_c_a01,pcg4_b_c_a01,pcg5_b_c_a01,pcg6_b_c_a01,pcg7_b_c_a01,pcg8_b_c_a01,pcg9_b_c_a01,pcg1_b_o_a01,pcg2_b_o_a01,pcg3_b_o_a01,pcg4_b_o_a01,pcg5_b_o_a01,pcg6_b_o_a01,pcg7_b_o_a01,pcg8_b_o_a01,pcg9_b_o_a01,opcg1_b_c_a01,opcg2_b_c_a01,opcg3_b_c_a01,opcg4_b_c_a01,opcg5_b_c_a01,opcg6_b_c_a01,opcg7_b_c_a01,opcg8_b_c_a01,opcg1_b_o_a01,opcg2_b_o_a01,opcg3_b_o_a01,opcg4_b_o_a01,opcg5_b_o_a01,opcg6_b_o_a01,opcg7_b_o_a01,opcg8_b_o_a01,pcg1_f_c_a01,pcg2_f_c_a01,pcg3_f_c_a01,pcg4_f_c_a01,pcg5_f_c_a01,pcg6_f_c_a01,pcg7_f_c_a01,pcg8_f_c_a01,pcg9_f_c_a01,pcg1_f_o_a01,pcg2_f_o_a01,pcg3_f_o_a01,pcg4_f_o_a01,pcg5_f_o_a01,pcg6_f_o_a01,pcg7_f_o_a01,pcg8_f_o_a01,pcg9_f_o_a01,opcg1_f_c_a01,opcg2_f_c_a01,opcg3_f_c_a01,opcg4_f_c_a01,opcg5_f_c_a01,opcg6_f_c_a01,opcg7_f_c_a01,opcg8_f_c_a01,opcg1_f_o_a01,opcg2_f_o_a01,opcg3_f_o_a01,opcg4_f_o_a01,opcg5_f_o_a01,opcg6_f_o_a01,opcg7_f_o_a01,opcg8_f_o_a01,num_a01,so4_a02,no3_a02,cl_a02,nh4_a02,na_a02,oin_a02,oc_a02,bc_a02,hysw_a02,water_a02,aro1_a02,aro2_a02,alk1_a02,ole1_a02,api1_a02,api2_a02,lim1_a02,lim2_a02,pcg1_b_c_a02,pcg2_b_c_a02,pcg3_b_c_a02,pcg4_b_c_a02,pcg5_b_c_a02,pcg6_b_c_a02,pcg7_b_c_a02,pcg8_b_c_a02,pcg9_b_c_a02,pcg1_b_o_a02,pcg2_b_o_a02,pcg3_b_o_a02,pcg4_b_o_a02,pcg5_b_o_a02,pcg6_b_o_a02,pcg7_b_o_a02,pcg8_b_o_a02,pcg9_b_o_a02,opcg1_b_c_a02,opcg2_b_c_a02,opcg3_b_c_a02,opcg4_b_c_a02,opcg5_b_c_a02,opcg6_b_c_a02,opcg7_b_c_a02,opcg8_b_c_a02,opcg1_b_o_a02,opcg2_b_o_a02,opcg3_b_o_a02,opcg4_b_o_a02,opcg5_b_o_a02,opcg6_b_o_a02,opcg7_b_o_a02,opcg8_b_o_a02,pcg1_f_c_a02,pcg2_f_c_a02,pcg3_f_c_a02,pcg4_f_c_a02,pcg5_f_c_a02,pcg6_f_c_a02,pcg7_f_c_a02,pcg8_f_c_a02,pcg9_f_c_a02,pcg1_f_o_a02,pcg2_f_o_a02,pcg3_f_o_a02,pcg4_f_o_a02,pcg5_f_o_a02,pcg6_f_o_a02,pcg7_f_o_a02,pcg8_f_o_a02,pcg9_f_o_a02,opcg1_f_c_a02,opcg2_f_c_a02,opcg3_f_c_a02,opcg4_f_c_a02,opcg5_f_c_a02,opcg6_f_c_a02,opcg7_f_c_a02,opcg8_f_c_a02,opcg1_f_o_a02,opcg2_f_o_a02,opcg3_f_o_a02,opcg4_f_o_a02,opcg5_f_o_a02,opcg6_f_o_a02,opcg7_f_o_a02,opcg8_f_o_a02,num_a02,so4_a03,no3_a03,cl_a03,nh4_a03,na_a03,oin_a03,oc_a03,bc_a03,hysw_a03,water_a03,aro1_a03,aro2_a03,alk1_a03,ole1_a03,api1_a03,api2_a03,lim1_a03,lim2_a03,pcg1_b_c_a03,pcg2_b_c_a03,pcg3_b_c_a03,pcg4_b_c_a03,pcg5_b_c_a03,pcg6_b_c_a03,pcg7_b_c_a03,pcg8_b_c_a03,pcg9_b_c_a03,pcg1_b_o_a03,pcg2_b_o_a03,pcg3_b_o_a03,pcg4_b_o_a03,pcg5_b_o_a03,pcg6_b_o_a03,pcg7_b_o_a03,pcg8_b_o_a03,pcg9_b_o_a03,opcg1_b_c_a03,opcg2_b_c_a03,opcg3_b_c_a03,opcg4_b_c_a03,opcg5_b_c_a03,opcg6_b_c_a03,opcg7_b_c_a03,opcg8_b_c_a03,opcg1_b_o_a03,opcg2_b_o_a03,opcg3_b_o_a03,opcg4_b_o_a03,opcg5_b_o_a03,opcg6_b_o_a03,opcg7_b_o_a03,opcg8_b_o_a03,pcg1_f_c_a03,pcg2_f_c_a03,pcg3_f_c_a03,pcg4_f_c_a03,pcg5_f_c_a03,pcg6_f_c_a03,pcg7_f_c_a03,pcg8_f_c_a03,pcg9_f_c_a03,pcg1_f_o_a03,pcg2_f_o_a03,pcg3_f_o_a03,pcg4_f_o_a03,pcg5_f_o_a03,pcg6_f_o_a03,pcg7_f_o_a03,pcg8_f_o_a03,pcg9_f_o_a03,opcg1_f_c_a03,opcg2_f_c_a03,opcg3_f_c_a03,opcg4_f_c_a03,opcg5_f_c_a03,opcg6_f_c_a03,opcg7_f_c_a03,opcg8_f_c_a03,opcg1_f_o_a03,opcg2_f_o_a03,opcg3_f_o_a03,opcg4_f_o_a03,opcg5_f_o_a03,opcg6_f_o_a03,opcg7_f_o_a03,opcg8_f_o_a03,num_a03,so4_a04,no3_a04,cl_a04,nh4_a04,na_a04,oin_a04,oc_a04,bc_a04,hysw_a04,water_a04,aro1_a04,aro2_a04,alk1_a04,ole1_a04,api1_a04,api2_a04,lim1_a04,lim2_a04,pcg1_b_c_a04,pcg2_b_c_a04,pcg3_b_c_a04,pcg4_b_c_a04,pcg5_b_c_a04,pcg6_b_c_a04,pcg7_b_c_a04,pcg8_b_c_a04,pcg9_b_c_a04,pcg1_b_o_a04,pcg2_b_o_a04,pcg3_b_o_a04,pcg4_b_o_a04,pcg5_b_o_a04,pcg6_b_o_a04,pcg7_b_o_a04,pcg8_b_o_a04,pcg9_b_o_a04,opcg1_b_c_a04,opcg2_b_c_a04,opcg3_b_c_a04,opcg4_b_c_a04,opcg5_b_c_a04,opcg6_b_c_a04,opcg7_b_c_a04,opcg8_b_c_a04,opcg1_b_o_a04,opcg2_b_o_a04,opcg3_b_o_a04,opcg4_b_o_a04,opcg5_b_o_a04,opcg6_b_o_a04,opcg7_b_o_a04,opcg8_b_o_a04,pcg1_f_c_a04,pcg2_f_c_a04,pcg3_f_c_a04,pcg4_f_c_a04,pcg5_f_c_a04,pcg6_f_c_a04,pcg7_f_c_a04,pcg8_f_c_a04,pcg9_f_c_a04,pcg1_f_o_a04,pcg2_f_o_a04,pcg3_f_o_a04,pcg4_f_o_a04,pcg5_f_o_a04,pcg6_f_o_a04,pcg7_f_o_a04,pcg8_f_o_a04,pcg9_f_o_a04,opcg1_f_c_a04,opcg2_f_c_a04,opcg3_f_c_a04,opcg4_f_c_a04,opcg5_f_c_a04,opcg6_f_c_a04,opcg7_f_c_a04,opcg8_f_c_a04,opcg1_f_o_a04,opcg2_f_o_a04,opcg3_f_o_a04,opcg4_f_o_a04,opcg5_f_o_a04,opcg6_f_o_a04,opcg7_f_o_a04,opcg8_f_o_a04,num_a04,ca_a01,ca_a02,ca_a03,ca_a04,co3_a01,co3_a02,co3_a03,co3_a04
+
+
 
 #SAPRCNOV new package, automatically created using diff_mechanisSpc_wrfRegistry.m script (pablo-saide@uiowa.edu)
 package saprc99_kpp    chem_opt==195   -       chem:o3,h2o2,no,no2,no3,n2o5,hono,hno3,hno4,so2,h2so4,co,hcho,ccho,rcho,acet,mek,hcooh,meoh,etoh,cco_oh,rco_oh,gly,mgly,bacl,cres,bald,isoprod,methacro,mvk,prod2,dcb1,dcb2,dcb3,ethene,isoprene,isopoo,isopooh,iepox,isop2o2,isopooh2,psd1,c2h6,c3h8,c2h2,c3h6,alk3,alk4,alk5,aro1,aro2,ole1,ole2,terp,rno3,nphe,phen,pan,pan2,pbzn,ma_pan,co2,cco_ooh,rco_o2,rco_ooh,xn,xc,ho,ho2,c_o2,cooh,rooh,ro2_r,r2o2,ro2_n,cco_o2,bzco_o2,ma_rco3,sesq,nh3,hcl,ch4
 
+package saprc99_mosaic_4bin_vbs9_kpp    chem_opt==197   -       chem:o3,h2o2,no,no2,no3,n2o5,hono,hno3,hno4,so2,h2so4,co,hcho,ccho,rcho,acet,mek,hcooh,meoh,etoh,cco_oh,rco_oh,gly,mgly,bacl,cres,bald,isoprod,methacro,mvk,prod2,dcb1,dcb2,dcb3,ethene,isoprene,c2h6,c3h8,c2h2,c3h6,alk3,alk4,alk5,aro1,aro2,ole1,ole2,terp,rno3,nphe,phen,pan,pan2,pbzn,ma_pan,co2,cco_ooh,rco_o2,rco_ooh,xn,xc,ho,ho2,c_o2,cooh,rooh,ro2_r,r2o2,ro2_n,cco_o2,bzco_o2,ma_rco3,sesq,pcg1_b_c,pcg2_b_c,pcg3_b_c,pcg4_b_c,pcg5_b_c,pcg6_b_c,pcg7_b_c,pcg8_b_c,pcg9_b_c,pcg1_b_o,pcg2_b_o,pcg3_b_o,pcg4_b_o,pcg5_b_o,pcg6_b_o,pcg7_b_o,pcg8_b_o,pcg9_b_o,opcg1_b_c,opcg2_b_c,opcg3_b_c,opcg4_b_c,opcg5_b_c,opcg6_b_c,opcg7_b_c,opcg8_b_c,opcg1_b_o,opcg2_b_o,opcg3_b_o,opcg4_b_o,opcg5_b_o,opcg6_b_o,opcg7_b_o,opcg8_b_o,pcg1_f_c,pcg2_f_c,pcg3_f_c,pcg4_f_c,pcg5_f_c,pcg6_f_c,pcg7_f_c,pcg8_f_c,pcg9_f_c,pcg1_f_o,pcg2_f_o,pcg3_f_o,pcg4_f_o,pcg5_f_o,pcg6_f_o,pcg7_f_o,pcg8_f_o,pcg9_f_o,opcg1_f_c,opcg2_f_c,opcg3_f_c,opcg4_f_c,opcg5_f_c,opcg6_f_c,opcg7_f_c,opcg8_f_c,opcg1_f_o,opcg2_f_o,opcg3_f_o,opcg4_f_o,opcg5_f_o,opcg6_f_o,opcg7_f_o,opcg8_f_o,psd1,psd2,nh3,hcl,nume,den,ant1_c,ant2_c,ant3_c,ant4_c,ant1_o,ant2_o,ant3_o,ant4_o,biog1_c,biog2_c,biog3_c,biog4_c,biog1_o,biog2_o,biog3_o,biog4_o,ch4,so4_a01,no3_a01,cl_a01,nh4_a01,na_a01,oin_a01,oc_a01,bc_a01,hysw_a01,water_a01,pcg1_b_c_a01,pcg2_b_c_a01,pcg3_b_c_a01,pcg4_b_c_a01,pcg5_b_c_a01,pcg6_b_c_a01,pcg7_b_c_a01,pcg1_b_o_a01,pcg2_b_o_a01,pcg3_b_o_a01,pcg4_b_o_a01,pcg5_b_o_a01,pcg6_b_o_a01,pcg7_b_o_a01,opcg1_b_c_a01,opcg2_b_c_a01,opcg3_b_c_a01,opcg4_b_c_a01,opcg5_b_c_a01,opcg6_b_c_a01,opcg7_b_c_a01,opcg1_b_o_a01,opcg2_b_o_a01,opcg3_b_o_a01,opcg4_b_o_a01,opcg5_b_o_a01,opcg6_b_o_a01,opcg7_b_o_a01,pcg1_f_c_a01,pcg2_f_c_a01,pcg3_f_c_a01,pcg4_f_c_a01,pcg5_f_c_a01,pcg6_f_c_a01,pcg7_f_c_a01,pcg1_f_o_a01,pcg2_f_o_a01,pcg3_f_o_a01,pcg4_f_o_a01,pcg5_f_o_a01,pcg6_f_o_a01,pcg7_f_o_a01,opcg1_f_c_a01,opcg2_f_c_a01,opcg3_f_c_a01,opcg4_f_c_a01,opcg5_f_c_a01,opcg6_f_c_a01,opcg7_f_c_a01,opcg1_f_o_a01,opcg2_f_o_a01,opcg3_f_o_a01,opcg4_f_o_a01,opcg5_f_o_a01,opcg6_f_o_a01,opcg7_f_o_a01,ant1_c_a01,ant2_c_a01,ant3_c_a01,ant4_c_a01,ant1_o_a01,ant2_o_a01,ant3_o_a01,ant4_o_a01,biog1_c_a01,biog2_c_a01,biog3_c_a01,biog4_c_a01,biog1_o_a01,biog2_o_a01,biog3_o_a01,biog4_o_a01,num_a01,so4_a02,no3_a02,cl_a02,nh4_a02,na_a02,oin_a02,oc_a02,bc_a02,hysw_a02,water_a02,pcg1_b_c_a02,pcg2_b_c_a02,pcg3_b_c_a02,pcg4_b_c_a02,pcg5_b_c_a02,pcg6_b_c_a02,pcg7_b_c_a02,pcg1_b_o_a02,pcg2_b_o_a02,pcg3_b_o_a02,pcg4_b_o_a02,pcg5_b_o_a02,pcg6_b_o_a02,pcg7_b_o_a02,opcg1_b_c_a02,opcg2_b_c_a02,opcg3_b_c_a02,opcg4_b_c_a02,opcg5_b_c_a02,opcg6_b_c_a02,opcg7_b_c_a02,opcg1_b_o_a02,opcg2_b_o_a02,opcg3_b_o_a02,opcg4_b_o_a02,opcg5_b_o_a02,opcg6_b_o_a02,opcg7_b_o_a02,pcg1_f_c_a02,pcg2_f_c_a02,pcg3_f_c_a02,pcg4_f_c_a02,pcg5_f_c_a02,pcg6_f_c_a02,pcg7_f_c_a02,pcg1_f_o_a02,pcg2_f_o_a02,pcg3_f_o_a02,pcg4_f_o_a02,pcg5_f_o_a02,pcg6_f_o_a02,pcg7_f_o_a02,opcg1_f_c_a02,opcg2_f_c_a02,opcg3_f_c_a02,opcg4_f_c_a02,opcg5_f_c_a02,opcg6_f_c_a02,opcg7_f_c_a02,opcg1_f_o_a02,opcg2_f_o_a02,opcg3_f_o_a02,opcg4_f_o_a02,opcg5_f_o_a02,opcg6_f_o_a02,opcg7_f_o_a02,ant1_c_a02,ant2_c_a02,ant3_c_a02,ant4_c_a02,ant1_o_a02,ant2_o_a02,ant3_o_a02,ant4_o_a02,biog1_c_a02,biog2_c_a02,biog3_c_a02,biog4_c_a02,biog1_o_a02,biog2_o_a02,biog3_o_a02,biog4_o_a02,num_a02,so4_a03,no3_a03,cl_a03,nh4_a03,na_a03,oin_a03,oc_a03,bc_a03,hysw_a03,water_a03,pcg1_b_c_a03,pcg2_b_c_a03,pcg3_b_c_a03,pcg4_b_c_a03,pcg5_b_c_a03,pcg6_b_c_a03,pcg7_b_c_a03,pcg1_b_o_a03,pcg2_b_o_a03,pcg3_b_o_a03,pcg4_b_o_a03,pcg5_b_o_a03,pcg6_b_o_a03,pcg7_b_o_a03,opcg1_b_c_a03,opcg2_b_c_a03,opcg3_b_c_a03,opcg4_b_c_a03,opcg5_b_c_a03,opcg6_b_c_a03,opcg7_b_c_a03,opcg1_b_o_a03,opcg2_b_o_a03,opcg3_b_o_a03,opcg4_b_o_a03,opcg5_b_o_a03,opcg6_b_o_a03,opcg7_b_o_a03,pcg1_f_c_a03,pcg2_f_c_a03,pcg3_f_c_a03,pcg4_f_c_a03,pcg5_f_c_a03,pcg6_f_c_a03,pcg7_f_c_a03,pcg1_f_o_a03,pcg2_f_o_a03,pcg3_f_o_a03,pcg4_f_o_a03,pcg5_f_o_a03,pcg6_f_o_a03,pcg7_f_o_a03,opcg1_f_c_a03,opcg2_f_c_a03,opcg3_f_c_a03,opcg4_f_c_a03,opcg5_f_c_a03,opcg6_f_c_a03,opcg7_f_c_a03,opcg1_f_o_a03,opcg2_f_o_a03,opcg3_f_o_a03,opcg4_f_o_a03,opcg5_f_o_a03,opcg6_f_o_a03,opcg7_f_o_a03,ant1_c_a03,ant2_c_a03,ant3_c_a03,ant4_c_a03,ant1_o_a03,ant2_o_a03,ant3_o_a03,ant4_o_a03,biog1_c_a03,biog2_c_a03,biog3_c_a03,biog4_c_a03,biog1_o_a03,biog2_o_a03,biog3_o_a03,biog4_o_a03,num_a03,so4_a04,no3_a04,cl_a04,nh4_a04,na_a04,oin_a04,oc_a04,bc_a04,hysw_a04,water_a04,pcg1_b_c_a04,pcg2_b_c_a04,pcg3_b_c_a04,pcg4_b_c_a04,pcg5_b_c_a04,pcg6_b_c_a04,pcg7_b_c_a04,pcg1_b_o_a04,pcg2_b_o_a04,pcg3_b_o_a04,pcg4_b_o_a04,pcg5_b_o_a04,pcg6_b_o_a04,pcg7_b_o_a04,opcg1_b_c_a04,opcg2_b_c_a04,opcg3_b_c_a04,opcg4_b_c_a04,opcg5_b_c_a04,opcg6_b_c_a04,opcg7_b_c_a04,opcg1_b_o_a04,opcg2_b_o_a04,opcg3_b_o_a04,opcg4_b_o_a04,opcg5_b_o_a04,opcg6_b_o_a04,opcg7_b_o_a04,pcg1_f_c_a04,pcg2_f_c_a04,pcg3_f_c_a04,pcg4_f_c_a04,pcg5_f_c_a04,pcg6_f_c_a04,pcg7_f_c_a04,pcg1_f_o_a04,pcg2_f_o_a04,pcg3_f_o_a04,pcg4_f_o_a04,pcg5_f_o_a04,pcg6_f_o_a04,pcg7_f_o_a04,opcg1_f_c_a04,opcg2_f_c_a04,opcg3_f_c_a04,opcg4_f_c_a04,opcg5_f_c_a04,opcg6_f_c_a04,opcg7_f_c_a04,opcg1_f_o_a04,opcg2_f_o_a04,opcg3_f_o_a04,opcg4_f_o_a04,opcg5_f_o_a04,opcg6_f_o_a04,opcg7_f_o_a04,ant1_c_a04,ant2_c_a04,ant3_c_a04,ant4_c_a04,ant1_o_a04,ant2_o_a04,ant3_o_a04,ant4_o_a04,biog1_c_a04,biog2_c_a04,biog3_c_a04,biog4_c_a04,biog1_o_a04,biog2_o_a04,biog3_o_a04,biog4_o_a04,num_a04,ca_a01,ca_a02,ca_a03,ca_a04,co3_a01,co3_a02,co3_a03,co3_a04
+
+
 package saprc99_mosaic_4bin_vbs2_kpp    chem_opt==198   -       chem:o3,h2o2,no,no2,no3,n2o5,hono,hno3,hno4,so2,h2so4,co,hcho,ccho,rcho,acet,mek,hcooh,meoh,etoh,cco_oh,rco_oh,gly,mgly,bacl,cres,bald,isoprod,methacro,mvk,prod2,dcb1,dcb2,dcb3,ethene,isoprene,c2h6,c3h8,c2h2,c3h6,alk3,alk4,alk5,aro1,aro2,ole1,ole2,terp,rno3,nphe,phen,pan,pan2,pbzn,ma_pan,co2,cco_ooh,rco_o2,rco_ooh,xn,xc,ho,ho2,c_o2,cooh,rooh,ro2_r,r2o2,ro2_n,cco_o2,bzco_o2,ma_rco3,sesq,pcg1_b_c,pcg2_b_c,pcg1_b_o,pcg2_b_o,opcg1_b_c,opcg1_b_o,pcg1_f_c,pcg2_f_c,pcg1_f_o,pcg2_f_o,opcg1_f_c,opcg1_f_o,psd1,psd2,nh3,hcl,nume,den,ant1_c,ant1_o,biog1_c,biog1_o,ch4,so4_a01,no3_a01,cl_a01,nh4_a01,na_a01,oin_a01,oc_a01,bc_a01,hysw_a01,water_a01,pcg1_b_c_a01,pcg2_b_c_a01,pcg1_b_o_a01,pcg2_b_o_a01,opcg1_b_c_a01,opcg1_b_o_a01,pcg1_f_c_a01,pcg2_f_c_a01,pcg1_f_o_a01,pcg2_f_o_a01,opcg1_f_c_a01,opcg1_f_o_a01,ant1_c_a01,ant1_o_a01,biog1_c_a01,biog1_o_a01,num_a01,so4_a02,no3_a02,cl_a02,nh4_a02,na_a02,oin_a02,oc_a02,bc_a02,hysw_a02,water_a02,pcg1_b_c_a02,pcg2_b_c_a02,pcg1_b_o_a02,pcg2_b_o_a02,opcg1_b_c_a02,opcg1_b_o_a02,pcg1_f_c_a02,pcg2_f_c_a02,pcg1_f_o_a02,pcg2_f_o_a02,opcg1_f_c_a02,opcg1_f_o_a02,ant1_c_a02,ant1_o_a02,biog1_c_a02,biog1_o_a02,num_a02,so4_a03,no3_a03,cl_a03,nh4_a03,na_a03,oin_a03,oc_a03,bc_a03,hysw_a03,water_a03,pcg1_b_c_a03,pcg2_b_c_a03,pcg1_b_o_a03,pcg2_b_o_a03,opcg1_b_c_a03,opcg1_b_o_a03,pcg1_f_c_a03,pcg2_f_c_a03,pcg1_f_o_a03,pcg2_f_o_a03,opcg1_f_c_a03,opcg1_f_o_a03,ant1_c_a03,ant1_o_a03,biog1_c_a03,biog1_o_a03,num_a03,so4_a04,no3_a04,cl_a04,nh4_a04,na_a04,oin_a04,oc_a04,bc_a04,hysw_a04,water_a04,pcg1_b_c_a04,pcg2_b_c_a04,pcg1_b_o_a04,pcg2_b_o_a04,opcg1_b_c_a04,opcg1_b_o_a04,pcg1_f_c_a04,pcg2_f_c_a04,pcg1_f_o_a04,pcg2_f_o_a04,opcg1_f_c_a04,opcg1_f_o_a04,ant1_c_a04,ant1_o_a04,biog1_c_a04,biog1_o_a04,num_a04,ca_a01,ca_a02,ca_a03,ca_a04,co3_a01,co3_a02,co3_a03,co3_a04
 
+package cbmz_mosaic_4bin_vbs2_kpp    chem_opt==199   -       chem:so2,sulf,no2,no,o3,hno3,h2o2,ald,hcho,op1,op2,ora1,ora2,nh3,n2o5,no3,pan,eth,co,ol2,olt,oli,tol,xyl,hono,hno4,ket,mgly,onit,csl,iso,ho,ho2,hcl,ch3o2,ethp,ch3oh,c2h5oh,par,to2,cro,open,op3,c2o3,ro2,ano2,nap,xo2,xpar,isoprd,isopp,isopn,isopo2,aro1,aro2,alk1,ole1,api1,api2,lim1,lim2,api,lim,pcg1_b_c,pcg2_b_c,pcg1_b_o,pcg2_b_o,opcg1_b_c,opcg1_b_o,pcg1_f_c,pcg2_f_c,pcg1_f_o,pcg2_f_o,opcg1_f_c,opcg1_f_o,psd1,psd2,nh3,hcl,ch4,so4_a01,no3_a01,cl_a01,nh4_a01,na_a01,oin_a01,oc_a01,bc_a01,hysw_a01,water_a01,pcg1_b_c_a01,pcg2_b_c_a01,pcg1_b_o_a01,pcg2_b_o_a01,opcg1_b_c_a01,opcg1_b_o_a01,pcg1_f_c_a01,pcg2_f_c_a01,pcg1_f_o_a01,pcg2_f_o_a01,opcg1_f_c_a01,opcg1_f_o_a01,ant1_c_a01,ant1_o_a01,biog1_c_a01,biog1_o_a01,num_a01,so4_a02,no3_a02,cl_a02,nh4_a02,na_a02,oin_a02,oc_a02,bc_a02,hysw_a02,water_a02,pcg1_b_c_a02,pcg2_b_c_a02,pcg1_b_o_a02,pcg2_b_o_a02,opcg1_b_c_a02,opcg1_b_o_a02,pcg1_f_c_a02,pcg2_f_c_a02,pcg1_f_o_a02,pcg2_f_o_a02,opcg1_f_c_a02,opcg1_f_o_a02,ant1_c_a02,ant1_o_a02,biog1_c_a02,biog1_o_a02,num_a02,so4_a03,no3_a03,cl_a03,nh4_a03,na_a03,oin_a03,oc_a03,bc_a03,hysw_a03,water_a03,pcg1_b_c_a03,pcg2_b_c_a03,pcg1_b_o_a03,pcg2_b_o_a03,opcg1_b_c_a03,opcg1_b_o_a03,pcg1_f_c_a03,pcg2_f_c_a03,pcg1_f_o_a03,pcg2_f_o_a03,opcg1_f_c_a03,opcg1_f_o_a03,ant1_c_a03,ant1_o_a03,biog1_c_a03,biog1_o_a03,num_a03,so4_a04,no3_a04,cl_a04,nh4_a04,na_a04,oin_a04,oc_a04,bc_a04,hysw_a04,water_a04,pcg1_b_c_a04,pcg2_b_c_a04,pcg1_b_o_a04,pcg2_b_o_a04,opcg1_b_c_a04,opcg1_b_o_a04,pcg1_f_c_a04,pcg2_f_c_a04,pcg1_f_o_a04,pcg2_f_o_a04,opcg1_f_c_a04,opcg1_f_o_a04,ant1_c_a04,ant1_o_a04,biog1_c_a04,biog1_o_a04,num_a04,ca_a01,ca_a02,ca_a03,ca_a04,co3_a01,co3_a02,co3_a03,co3_a04
 package mozart_mosaic_4bin_kpp    chem_opt==201   -                        chem:o3,o1d_cb4,o,no,no2,no3,n2o5,hno3,hno4,so2,ho,ho2,h2o2,sulf,co,hcho,hcooh,c2h2,hoch2oo,ch3ooh,ch3o2,ch4,h2,eo2,ch3cooh,c2h4,n2o,ch3oh,aco3,acet,mgly,paa,gly,c3h6ooh,pan,mpan,macr,mvk,c3h6,etooh,prooh,acetp,xooh,onitr,isooh,acetol,glyald,mek,eto2,open,alkooh,mekooh,tolooh,terpooh,ald,mco3,c2h5oh,eo,c2h6,c3h8,pro2,po2,aceto2,bigene,bigalk,eneo2,alko2,isopr,iso2,mvko2,mvkooh,hydrald,xo2,apin,bpin,limon,myrc,bcary,terprod1,terprod2,terp2o2,terp2ooh,nterpo2,terpo2,tol,cres,to2,onit,isopn,dms,mbo,mboo2,hmprop,hmpropo2,mboooh,mbono3o2,nh3,nume,den,voca,vocbb,smpa,smpbb,biog1_c,biog1_o,benzene,phen,bepomuc,benzo2,pheno2,pheno,phenooh,c6h5o2,c6h5ooh,benzooh,bigald1,bigald2,bigald3,bigald4,malo2,tepomuc,bzoo,bzooh,bald,acbzo2,dicarbo2,mdialo2,xyl,xylol,xylolo2,xylolooh,xyleno2,xylenooh,pbznit,hono,meko2,so4_a01,no3_a01,smpa_a01,smpbb_a01,glysoa_sfc_a01,biog1_c_a01,biog1_o_a01,cl_a01,co3_a01,nh4_a01,na_a01,ca_a01,oin_a01,oc_a01,bc_a01,hysw_a01,water_a01,num_a01,so4_a02,no3_a02,smpa_a02,smpbb_a02,glysoa_sfc_a02,biog1_c_a02,biog1_o_a02,cl_a02,co3_a02,nh4_a02,na_a02,ca_a02,oin_a02,oc_a02,bc_a02,hysw_a02,water_a02,num_a02,so4_a03,no3_a03,smpa_a03,smpbb_a03,glysoa_sfc_a03,biog1_c_a03,biog1_o_a03,cl_a03,co3_a03,nh4_a03,na_a03,ca_a03,oin_a03,oc_a03,bc_a03,hysw_a03,water_a03,num_a03,so4_a04,no3_a04,smpa_a04,smpbb_a04,glysoa_sfc_a04,biog1_c_a04,biog1_o_a04,cl_a04,co3_a04,nh4_a04,na_a04,ca_a04,oin_a04,oc_a04,bc_a04,hysw_a04,water_a04,num_a04
 # complete aq-phase chem. and wet scavenging version with MOZART, HONO, VOC reactivity + VBS SOA
 package   mozart_mosaic_4bin_aq_kpp  chem_opt==202           -             chem:o3,o1d_cb4,o,no,no2,no3,n2o5,hno3,hno4,so2,ho,ho2,h2o2,sulf,co,hcho,hcooh,c2h2,hoch2oo,ch3ooh,ch3o2,ch4,h2,eo2,ch3cooh,c2h4,n2o,ch3oh,aco3,acet,mgly,paa,gly,c3h6ooh,pan,mpan,macr,mvk,c3h6,etooh,prooh,acetp,xooh,onitr,isooh,acetol,glyald,mek,eto2,open,alkooh,mekooh,tolooh,terpooh,ald,mco3,c2h5oh,eo,c2h6,c3h8,pro2,po2,aceto2,bigene,bigalk,eneo2,alko2,isopr,iso2,mvko2,mvkooh,hydrald,xo2,apin,bpin,limon,myrc,bcary,terprod1,terprod2,terp2o2,terp2ooh,nterpo2,terpo2,tol,cres,to2,onit,isopn,dms,mbo,mboo2,hmprop,hmpropo2,mboooh,mbono3o2,nh3,nume,den,cvasoaX,cvasoa1,cvasoa2,cvasoa3,cvasoa4,cvbsoaX,cvbsoa1,cvbsoa2,cvbsoa3,cvbsoa4,benzene,phen,bepomuc,benzo2,pheno2,pheno,phenooh,c6h5o2,c6h5ooh,benzooh,bigald1,bigald2,bigald3,bigald4,malo2,tepomuc,bzoo,bzooh,bald,acbzo2,dicarbo2,mdialo2,xyl,xylol,xylolo2,xylolooh,xyleno2,xylenooh,pbznit,hono,meko2,so4_a01,no3_a01,asoaX_a01,asoa1_a01,asoa2_a01,asoa3_a01,asoa4_a01,bsoaX_a01,bsoa1_a01,bsoa2_a01,bsoa3_a01,bsoa4_a01,glysoa_r1_a01,glysoa_r2_a01,glysoa_sfc_a01,glysoa_nh4_a01,glysoa_oh_a01,cl_a01,co3_a01,nh4_a01,na_a01,ca_a01,oin_a01,oc_a01,bc_a01,hysw_a01,water_a01,num_a01,so4_a02,no3_a02,asoaX_a02,asoa1_a02,asoa2_a02,asoa3_a02,asoa4_a02,bsoaX_a02,bsoa1_a02,bsoa2_a02,bsoa3_a02,bsoa4_a02,glysoa_r1_a02,glysoa_r2_a02,glysoa_sfc_a02,glysoa_nh4_a02,glysoa_oh_a02,cl_a02,co3_a02,nh4_a02,na_a02,ca_a02,oin_a02,oc_a02,bc_a02,hysw_a02,water_a02,num_a02,so4_a03,no3_a03,asoaX_a03,asoa1_a03,asoa2_a03,asoa3_a03,asoa4_a03,bsoaX_a03,bsoa1_a03,bsoa2_a03,bsoa3_a03,bsoa4_a03,glysoa_r1_a03,glysoa_r2_a03,glysoa_sfc_a03,glysoa_nh4_a03,glysoa_oh_a03,cl_a03,co3_a03,nh4_a03,na_a03,ca_a03,oin_a03,oc_a03,bc_a03,hysw_a03,water_a03,num_a03,so4_a04,no3_a04,asoaX_a04,asoa1_a04,asoa2_a04,asoa3_a04,asoa4_a04,bsoaX_a04,bsoa1_a04,bsoa2_a04,bsoa3_a04,bsoa4_a04,glysoa_r1_a04,glysoa_r2_a04,glysoa_sfc_a04,glysoa_nh4_a04,glysoa_oh_a04,cl_a04,co3_a04,nh4_a04,na_a04,ca_a04,oin_a04,oc_a04,bc_a04,hysw_a04,water_a04,num_a04,so4_cw01,no3_cw01,asoaX_cw01,asoa1_cw01,asoa2_cw01,asoa3_cw01,asoa4_cw01,bsoaX_cw01,bsoa1_cw01,bsoa2_cw01,bsoa3_cw01,bsoa4_cw01,glysoa_r1_cw01,glysoa_r2_cw01,glysoa_sfc_cw01,glysoa_nh4_cw01,glysoa_oh_cw01,cl_cw01,co3_cw01,nh4_cw01,na_cw01,ca_cw01,oin_cw01,oc_cw01,bc_cw01,num_cw01,so4_cw02,no3_cw02,asoaX_cw02,asoa1_cw02,asoa2_cw02,asoa3_cw02,asoa4_cw02,bsoaX_cw02,bsoa1_cw02,bsoa2_cw02,bsoa3_cw02,bsoa4_cw02,glysoa_r1_cw02,glysoa_r2_cw02,glysoa_sfc_cw02,glysoa_nh4_cw02,glysoa_oh_cw02,cl_cw02,co3_cw02,nh4_cw02,na_cw02,ca_cw02,oin_cw02,oc_cw02,bc_cw02,num_cw02,so4_cw03,no3_cw03,asoaX_cw03,asoa1_cw03,asoa2_cw03,asoa3_cw03,asoa4_cw03,bsoaX_cw03,bsoa1_cw03,bsoa2_cw03,bsoa3_cw03,bsoa4_cw03,glysoa_r1_cw03,glysoa_r2_cw03,glysoa_sfc_cw03,glysoa_nh4_cw03,glysoa_oh_cw03,cl_cw03,co3_cw03,nh4_cw03,na_cw03,ca_cw03,oin_cw03,oc_cw03,bc_cw03,num_cw03,so4_cw04,no3_cw04,asoaX_cw04,asoa1_cw04,asoa2_cw04,asoa3_cw04,asoa4_cw04,bsoaX_cw04,bsoa1_cw04,bsoa2_cw04,bsoa3_cw04,bsoa4_cw04,glysoa_r1_cw04,glysoa_r2_cw04,glysoa_sfc_cw04,glysoa_nh4_cw04,glysoa_oh_cw04,cl_cw04,co3_cw04,nh4_cw04,na_cw04,ca_cw04,oin_cw04,oc_cw04,bc_cw04,num_cw04
@@ -4378,6 +4399,7 @@ package   biomassb      biomass_burn_opt==1             -          state:mean_fc
 package   biomassb_mozc      biomass_burn_opt==2             -          state:mean_fct_agtf,mean_fct_agef,mean_fct_agsv,mean_fct_aggr,firesize_agtf,firesize_agef,firesize_agsv,firesize_aggr;ebu:ebu_co,ebu_no,ebu_no2,ebu_bigalk,ebu_bigene,ebu_c2h4,ebu_c2h5oh,ebu_c2h6,ebu_c3h6,ebu_c3h8,ebu_ch2o,ebu_ch3cho,ebu_ch3coch3,ebu_ch3oh,ebu_mek,ebu_so2,ebu_toluene,ebu_nh3,ebu_oc,ebu_bc,ebu_pm25,ebu_pm10,ebu_open,ebu_c10h16,ebu_mgly,ebu_ch3cooh,ebu_cres,ebu_glyald,ebu_gly,ebu_acetol,ebu_isop,ebu_macr,ebu_mvk;ebu_in:ebu_in_co,ebu_in_no,ebu_in_bigalk,ebu_in_bigene,ebu_in_c2h4,ebu_in_c2h5oh,ebu_in_c2h6,ebu_in_c3h6,ebu_in_c3h8,ebu_in_ch2o,ebu_in_ch3cho,ebu_in_ch3coch3,ebu_in_ch3oh,ebu_in_mek,ebu_in_so2,ebu_in_toluene,ebu_in_nh3,ebu_in_no2,ebu_in_open,ebu_in_c10h16,ebu_in_mgly,ebu_in_ch3cooh,ebu_in_cres,ebu_in_glyald,ebu_in_gly,ebu_in_acetol,ebu_in_isop,ebu_in_macr,ebu_in_mvk,ebu_in_pm25,ebu_in_pm10,ebu_in_oc,ebu_in_bc
 package   biomassb_moz       biomass_burn_opt==3             -          state:mean_fct_agtf,mean_fct_agef,mean_fct_agsv,mean_fct_aggr,firesize_agtf,firesize_agef,firesize_agsv,firesize_aggr;ebu:ebu_co,ebu_no,ebu_no2,ebu_bigalk,ebu_bigene,ebu_c2h4,ebu_c2h5oh,ebu_c2h6,ebu_c3h6,ebu_c3h8,ebu_ch2o,ebu_ch3cho,ebu_ch3coch3,ebu_ch3oh,ebu_mek,ebu_so2,ebu_toluene,ebu_nh3,ebu_open,ebu_c10h16,ebu_mgly,ebu_ch3cooh,ebu_cres,ebu_glyald,ebu_gly,ebu_acetol,ebu_isop,ebu_macr,ebu_mvk;ebu_in:ebu_in_co,ebu_in_no,ebu_in_bigalk,ebu_in_bigene,ebu_in_c2h4,ebu_in_c2h5oh,ebu_in_c2h6,ebu_in_c3h6,ebu_in_c3h8,ebu_in_ch2o,ebu_in_ch3cho,ebu_in_ch3coch3,ebu_in_ch3oh,ebu_in_mek,ebu_in_so2,ebu_in_toluene,ebu_in_nh3,ebu_in_no2,ebu_in_open,ebu_in_c10h16,ebu_in_mgly,ebu_in_ch3cooh,ebu_in_cres,ebu_in_glyald,ebu_in_gly,ebu_in_acetol,ebu_in_isop,ebu_in_macr,ebu_in_mvk
 package   biomassb_t1_mozcart   biomass_burn_opt==4          -          state:mean_fct_agtf,mean_fct_agef,mean_fct_agsv,mean_fct_aggr,firesize_agtf,firesize_agef,firesize_agsv,firesize_aggr;ebu:ebu_co,ebu_no,ebu_no2,ebu_bigalk,ebu_bigene,ebu_c2h4,ebu_c2h5oh,ebu_c2h6,ebu_c3h6,ebu_c3h8,ebu_ch2o,ebu_ch3cho,ebu_ch3coch3,ebu_ch3oh,ebu_mek,ebu_so2,ebu_toluene,ebu_nh3,ebu_oc,ebu_bc,ebu_pm25,ebu_pm10,ebu_mgly,ebu_ch3cooh,ebu_cres,ebu_glyald,ebu_acetol,ebu_isop,ebu_macr,ebu_mvk,ebu_apin,ebu_benzene,ebu_ch3cn,ebu_hcn,ebu_hcooh,ebu_c2h2,ebu_dms,ebu_hpald,ebu_xylenes;ebu_in:ebu_in_co,ebu_in_no,ebu_in_bigalk,ebu_in_bigene,ebu_in_c2h4,ebu_in_c2h5oh,ebu_in_c2h6,ebu_in_c3h6,ebu_in_c3h8,ebu_in_ch2o,ebu_in_ch3cho,ebu_in_ch3coch3,ebu_in_ch3oh,ebu_in_mek,ebu_in_so2,ebu_in_toluene,ebu_in_nh3,ebu_in_no2,ebu_in_mgly,ebu_in_ch3cooh,ebu_in_cres,ebu_in_glyald,ebu_in_acetol,ebu_in_isop,ebu_in_macr,ebu_in_mvk,ebu_in_pm25,ebu_in_pm10,ebu_in_oc,ebu_in_bc,ebu_in_apin,ebu_in_benzene,ebu_in_ch3cn,ebu_in_hcn,ebu_in_hcooh,ebu_in_c2h2,ebu_in_dms,ebu_in_hpald,ebu_in_xylenes
+package   biomassb_cbmz      biomass_burn_opt==14             -          state:mean_fct_agtf,mean_fct_agef,mean_fct_agsv,mean_fct_aggr,firesize_agtf,firesize_agef,firesize_agsv,firesize_aggr;ebu:ebu_co,ebu_no,ebu_no2,ebu_c2h4,ebu_c2h5oh,ebu_c2h6,ebu_c3h6,ebu_c3h8,ebu_ch2o,ebu_ch3cho,ebu_ch3coch3,ebu_ch3oh,ebu_mek,ebu_so2,ebu_toluene,ebu_nh3,ebu_oc,ebu_bc,ebu_pm25,ebu_pm10,ebu_open,ebu_c10h16,ebu_mgly,ebu_ch3cooh,ebu_glyald,ebu_gly,ebu_acetol,ebu_isop,ebu_macr,ebu_mvk,ebu_ol2,ebu_par,ebu_eth,ebu_olt,ebu_oli,ebu_iso,ebu_tol,ebu_csl,ebu_hcho,ebu_ald,ebu_ket,ebu_xyl,ebu_ora1,ebu_ora2,ebu_co2,ebu_ete,ebu_dien,ebu_api,ebu_lim;ebu_in:ebu_in_co,ebu_in_no,ebu_in_c2h4,ebu_in_c2h5oh,ebu_in_c2h6,ebu_in_c3h6,ebu_in_c3h8,ebu_in_ch2o,ebu_in_ch3cho,ebu_in_ch3coch3,ebu_in_ch3oh,ebu_in_mek,ebu_in_so2,ebu_in_toluene,ebu_in_nh3,ebu_in_no2,ebu_in_open,ebu_in_c10h16,ebu_in_mgly,ebu_in_ch3cooh,ebu_in_glyald,ebu_in_gly,ebu_in_acetol,ebu_in_isop,ebu_in_macr,ebu_in_mvk,ebu_in_pm25,ebu_in_pm10,ebu_in_oc,ebu_in_bc,ebu_in_ol2,ebu_in_par,ebu_in_eth,ebu_in_olt,ebu_in_oli,ebu_in_iso,ebu_in_tol,ebu_in_csl,ebu_in_hcho,ebu_in_ald,ebu_in_ket,ebu_in_xyl,ebu_in_ora1,ebu_in_ora2,ebu_in_co2,ebu_in_ete,ebu_in_dien,ebu_in_api,ebu_in_bc
 
 # GHG biomass burning
 package   biomassb_ghg  biomass_burn_opt==5          -             state::mean_fct_agtf,mean_fct_agef,mean_fct_agsv,mean_fct_aggr,firesize_agtf,firesize_agef,firesize_agsv,firesize_aggr;ebu:ebu_co,ebu_co2,ebu_ch4;ebu_in:ebu_in_co,ebu_in_co2,ebu_in_ch4
diff --git a/chem/emissions_driver.F b/chem/emissions_driver.F
index e2af4b2f..f9ace758 100644
--- a/chem/emissions_driver.F
+++ b/chem/emissions_driver.F
@@ -645,6 +645,9 @@ CONTAINS
            config_flags%biomass_burn_opt == BIOMASSB_MOZ  .OR. &
            config_flags%biomass_burn_opt == BIOMASSB_SAPRC .OR. &
            config_flags%biomass_burn_opt == BIOMASSB_GHG  .OR. &
+!lm Add a biomass burning emissions package for CBMZ
+           config_flags%biomass_burn_opt == BIOMASSB_CBMZ .OR. &
+!lm
            config_flags%biomass_burn_opt == BIOMASSB ) then
         IF ( ktau==1 ) then
            do_plumerisefire = .true.
@@ -701,6 +704,9 @@ CONTAINS
 !
        call add_emis_burn(id,dtstep,ktau,dz8w,rho_phy,tracer,&
             julday,gmt,xlat,xlong,t_phy,p_phy,                           &
+!lm
+            alt, &
+!lm
             ebu,0,config_flags%tracer_opt,config_flags%biomass_burn_opt,     &
             num_tracer,ids,ide, jds,jde, kds,kde,                                   &
             ims,ime, jms,jme, kms,kme,                                   &
@@ -807,7 +813,10 @@ CONTAINS
 !!! ***********   FIRE AND CHEM ****************************************
 !
     fire_select:  SELECT CASE(config_flags%biomass_burn_opt)
-     CASE (BIOMASSB,BIOMASSB_MOZC,BIOMASSB_MOZ,BIOMASSB_T1_MOZCART,BIOMASSB_GHG,BIOMASSB_SAPRC)
+!lm Add a biomass burning emission package for CBMZ
+!     CASE (BIOMASSB,BIOMASSB_MOZC,BIOMASSB_MOZ,BIOMASSB_T1_MOZCART,BIOMASSB_GHG,BIOMASSB_SAPRC)
+     CASE (BIOMASSB,BIOMASSB_CBMZ,BIOMASSB_MOZC,BIOMASSB_MOZ,BIOMASSB_T1_MOZCART,BIOMASSB_GHG,BIOMASSB_SAPRC)
+!lm
 !      if( do_plumerisefire )then
 !         CALL wrf_debug(15,'fire emissions: calling biomassb')
 !         write(0,*)ktau,stepfirepl
@@ -826,6 +835,9 @@ CONTAINS
        CALL wrf_debug(15,'fire emissions: adding biomassb emissions')
        call add_emis_burn(id,dtstep,ktau,dz8w,rho_phy,chem,&
             julday,gmt,xlat,xlong,t_phy,p_phy,                           &
+!lm 
+            alt, &
+!lm
             ebu,config_flags%chem_opt,0,config_flags%biomass_burn_opt,     &
             num_chem,ids,ide, jds,jde, kds,kde,                                   &
             ims,ime, jms,jme, kms,kme,                                   &
diff --git a/chem/module_add_emiss_burn.F b/chem/module_add_emiss_burn.F
index 722fc51f..a31951b4 100644
--- a/chem/module_add_emiss_burn.F
+++ b/chem/module_add_emiss_burn.F
@@ -2,6 +2,9 @@ Module module_add_emiss_burn
 CONTAINS
        subroutine add_emis_burn(id,dtstep,ktau,dz8w,rho_phy,chem,       &
             julday,gmt,xlat,xlong,t_phy,p_phy,                          &
+!lm
+            alt, &
+!lm
             ebu,chem_opt,tracer_opt,biomass_burn_opt,                   &
             num_c,ids,ide, jds,jde, kds,kde,                            &
             ims,ime, jms,jme, kms,kme,                                  &
@@ -35,6 +38,10 @@ CONTAINS
                                                       p_phy,               &
                                                       dz8w,                &
                                                     rho_phy
+!lm
+   REAL,  DIMENSION( ims:ime , kms:kme , jms:jme )         ,               &
+          INTENT(IN   ) ::                            alt
+!lm
 
       REAL,      INTENT(IN   ) ::                                          &
                              dtstep,gmt
@@ -447,6 +454,45 @@ CONTAINS
           enddo
           enddo
         endif
+!jcr : case cmbz
+       CASE (CBMZ, CBMZ_BB, CBMZ_BB_KPP, CBMZ_MOSAIC_4BIN, CBMZ_MOSAIC_8BIN, &
+          CBMZ_MOSAIC_4BIN_AQ, CBMZ_MOSAIC_8BIN_AQ, &
+          CBMZSORG, CBMZSORG_AQ, CBMZ_MOSAIC_DMS_4BIN, CBMZ_MOSAIC_DMS_8BIN, &
+          CBMZ_MOSAIC_KPP, &
+          CBMZ_MOSAIC_DMS_4BIN_AQ, CBMZ_MOSAIC_DMS_8BIN_AQ)
+        if( biomass_burn_opt == BIOMASSB_CBMZ ) then
+          call wrf_debug(15,'adding fire emissions for CBMZ')
+          do j=jts,jte
+            do k=kts,kte
+              do i=its,ite
+                conv_rho = (r_q*4.828e-4*dtstep)/(rho_phy(i,k,j)*60.*dz8w(i,k,j))
+                chem(i,k,j,p_no2) = chem(i,k,j,p_no2) + ebu(i,k,j,p_ebu_no2)*conv_rho
+                chem(i,k,j,p_c2h5oh) = chem(i,k,j,p_c2h5oh) + ebu(i,k,j,p_ebu_c2h5oh)*conv_rho
+                chem(i,k,j,p_par) = chem(i,k,j,p_par) + ebu(i,k,j,p_ebu_par)*conv_rho
+                chem(i,k,j,p_ch3oh) = chem(i,k,j,p_ch3oh) + ebu(i,k,j,p_ebu_ch3oh)*conv_rho
+                chem(i,k,j,p_csl)  = chem(i,k,j,p_csl) + ebu(i,k,j,p_ebu_csl)*conv_rho
+                chem(i,k,j,p_so2)  = chem(i,k,j,p_so2) + ebu(i,k,j,p_ebu_so2)*conv_rho
+                chem(i,k,j,p_no)   = chem(i,k,j,p_no) + ebu(i,k,j,p_ebu_no)*conv_rho
+                chem(i,k,j,p_ald)  = chem(i,k,j,p_ald) + ebu(i,k,j,p_ebu_ald)*conv_rho
+                chem(i,k,j,p_hcho) = chem(i,k,j,p_hcho) + ebu(i,k,j,p_ebu_hcho)*conv_rho
+                chem(i,k,j,p_ora2) = chem(i,k,j,p_ora2) + ebu(i,k,j,p_ebu_ora2)*conv_rho
+                chem(i,k,j,p_nh3)  = chem(i,k,j,p_nh3) + ebu(i,k,j,p_ebu_nh3)*conv_rho
+                chem(i,k,j,p_eth)  = chem(i,k,j,p_eth) + ebu(i,k,j,p_ebu_eth)*conv_rho
+                chem(i,k,j,p_co)   = chem(i,k,j,p_co) + ebu(i,k,j,p_ebu_co)*conv_rho
+                chem(i,k,j,p_ol2)  = chem(i,k,j,p_ol2) + ebu(i,k,j,p_ebu_ol2)*conv_rho
+                chem(i,k,j,p_olt)  = chem(i,k,j,p_olt) + ebu(i,k,j,p_ebu_olt)*conv_rho
+                chem(i,k,j,p_oli)  = chem(i,k,j,p_oli) + ebu(i,k,j,p_ebu_oli)*conv_rho
+                chem(i,k,j,p_tol)  = chem(i,k,j,p_tol) + ebu(i,k,j,p_ebu_tol)*conv_rho
+                chem(i,k,j,p_xyl)  = chem(i,k,j,p_xyl) + ebu(i,k,j,p_ebu_xyl)*conv_rho
+                chem(i,k,j,p_ket)  = chem(i,k,j,p_ket) + ebu(i,k,j,p_ebu_ket)*conv_rho
+                chem(i,k,j,p_iso)  = chem(i,k,j,p_iso) + ebu(i,k,j,p_ebu_iso)*conv_rho
+                chem(i,k,j,p_ora1)  = chem(i,k,j,p_ora1) + ebu(i,k,j,p_ebu_ora1)*conv_rho
+              enddo
+            enddo
+          enddo
+        endif
+!jcr : end case cmbz
+
 !++lm New biomass burning emission package for SAPRC VBS2 mechanisms
         CASE (SAPRC99_MOSAIC_4BIN_VBS2_KPP, SAPRC99_MOSAIC_8BIN_VBS2_AQ_KPP, SAPRC99_MOSAIC_8BIN_VBS2_KPP)
         if( biomass_burn_opt == BIOMASSB_SAPRC ) then
diff --git a/chem/module_plumerise1.F b/chem/module_plumerise1.F
index 6f1a43a4..87adfae0 100644
--- a/chem/module_plumerise1.F
+++ b/chem/module_plumerise1.F
@@ -79,6 +79,9 @@ subroutine plumerise_driver (id,ktau,dtstep,                           &
 ! Local variables...
 !
       INTEGER :: nv, i, j, k, ksub, nspecies
+!lm:TO2 (moved to namelist)
+!      INTEGER :: ifplumerise
+!lm:TO2
 
 
 !     integer, parameter :: nspecies=num_ebu
@@ -88,11 +91,15 @@ subroutine plumerise_driver (id,ktau,dtstep,                           &
                               ,rho_phyin ,qv_in ,zmid    &
                               ,z_lev
 ! real, dimension(nveg_agreg) :: firesize,mean_fct
-      real :: sum, ffirs, ratio
+!lm I changed the variable name from sum to sum_fires because sum is
+! a Fortran function
+!      real :: sum, ffirs, ratio
+      real :: sum_fires, ffirs, ratio
+!lm
 !     real,save,dimension(its:ite,jts:jte) :: ffirs
       ffirs=0.
       nspecies=num_ebu
-!     write(0,*)'plumerise'
+      write(0,*)'config_flags%ifplumerise = ',config_flags%ifplumerise
 
       if( scale_fire_emiss ) then
         select case( config_flags%chem_opt )
@@ -109,7 +116,7 @@ subroutine plumerise_driver (id,ktau,dtstep,                           &
                ebu(i,kts,j,p_ebu_no2)=ebu_in(i,1,j,p_ebu_in_no2)
                ebu(i,kts,j,p_ebu_co)=ebu_in(i,1,j,p_ebu_in_co)
                ebu(i,kts,j,p_ebu_co2)=ebu_in(i,1,j,p_ebu_in_co2)
-              ebu(i,kts,j,p_ebu_nh3) = ebu_in(i,1,j,p_ebu_in_nh3)
+               ebu(i,kts,j,p_ebu_nh3) = ebu_in(i,1,j,p_ebu_in_nh3)
                ebu(i,kts,j,p_ebu_ch4) = ebu_in(i,1,j,p_ebu_in_ch4)
                ebu(i,kts,j,p_ebu_eth)=ebu_in(i,1,j,p_ebu_in_eth)
                ebu(i,kts,j,p_ebu_hc3)=ebu_in(i,1,j,p_ebu_in_hc3)
@@ -202,46 +209,46 @@ subroutine plumerise_driver (id,ktau,dtstep,                           &
 !++lm  New biomass burning emission package for SAPRC
        elseif ( config_flags%biomass_burn_opt == BIOMASSB_SAPRC ) then
          do j=jts,jte
-            do i=its,ite
-               ebu(i,kts,j,p_ebu_co) = ebu_in(i,1,j,p_ebu_in_co)
-               ebu(i,kts,j,p_ebu_no) = ebu_in(i,1,j,p_ebu_in_no)
-               ebu(i,kts,j,p_ebu_no2) = ebu_in(i,1,j,p_ebu_in_no2)
-               ebu(i,kts,j,p_ebu_so2) = ebu_in(i,1,j,p_ebu_in_so2)
-               ebu(i,kts,j,p_ebu_nh3) = ebu_in(i,1,j,p_ebu_in_nh3)
-               ebu(i,kts,j,p_ebu_ch4) = ebu_in(i,1,j,p_ebu_in_ch4)
-               ebu(i,kts,j,p_ebu_acet) = ebu_in(i,1,j,p_ebu_in_acet)
-               ebu(i,kts,j,p_ebu_c2h6) = ebu_in(i,1,j,p_ebu_in_c2h6)
-               ebu(i,kts,j,p_ebu_c3h8) = ebu_in(i,1,j,p_ebu_in_c3h8)
-               ebu(i,kts,j,p_ebu_alk3) = ebu_in(i,1,j,p_ebu_in_alk3)
-               ebu(i,kts,j,p_ebu_alk4) = ebu_in(i,1,j,p_ebu_in_alk4)
-               ebu(i,kts,j,p_ebu_alk5) = ebu_in(i,1,j,p_ebu_in_alk5)
-               ebu(i,kts,j,p_ebu_aro1) = ebu_in(i,1,j,p_ebu_in_aro1)
-               ebu(i,kts,j,p_ebu_aro2) = ebu_in(i,1,j,p_ebu_in_aro2)
-               ebu(i,kts,j,p_ebu_bald) = ebu_in(i,1,j,p_ebu_in_bald)
-               ebu(i,kts,j,p_ebu_ccho) = ebu_in(i,1,j,p_ebu_in_ccho)
-               ebu(i,kts,j,p_ebu_cco_oh) = ebu_in(i,1,j,p_ebu_in_cco_oh)
-               ebu(i,kts,j,p_ebu_ethene) = ebu_in(i,1,j,p_ebu_in_ethene)
-               ebu(i,kts,j,p_ebu_hcho) = ebu_in(i,1,j,p_ebu_in_hcho)
-               ebu(i,kts,j,p_ebu_hcooh) = ebu_in(i,1,j,p_ebu_in_hcooh)
-               ebu(i,kts,j,p_ebu_hono) = ebu_in(i,1,j,p_ebu_in_hono)
-               ebu(i,kts,j,p_ebu_isoprene) = ebu_in(i,1,j,p_ebu_in_isoprene)
-               ebu(i,kts,j,p_ebu_mek) = ebu_in(i,1,j,p_ebu_in_mek)
-               ebu(i,kts,j,p_ebu_meoh) = ebu_in(i,1,j,p_ebu_in_meoh)
-               ebu(i,kts,j,p_ebu_methacro) = ebu_in(i,1,j,p_ebu_in_methacro)
-               ebu(i,kts,j,p_ebu_mgly) = ebu_in(i,1,j,p_ebu_in_mgly)
-               ebu(i,kts,j,p_ebu_mvk) = ebu_in(i,1,j,p_ebu_in_mvk)
-               ebu(i,kts,j,p_ebu_ole1) = ebu_in(i,1,j,p_ebu_in_ole1)
-               ebu(i,kts,j,p_ebu_ole2) = ebu_in(i,1,j,p_ebu_in_ole2)
-               ebu(i,kts,j,p_ebu_phen) = ebu_in(i,1,j,p_ebu_in_phen)
-               ebu(i,kts,j,p_ebu_prod2) = ebu_in(i,1,j,p_ebu_in_prod2)
-               ebu(i,kts,j,p_ebu_rcho) = ebu_in(i,1,j,p_ebu_in_rcho)
-               ebu(i,kts,j,p_ebu_rno3) = ebu_in(i,1,j,p_ebu_in_rno3)
-               ebu(i,kts,j,p_ebu_terp) = ebu_in(i,1,j,p_ebu_in_terp)
-               ebu(i,kts,j,p_ebu_pm10) = ebu_in(i,1,j,p_ebu_in_pm10)
-               ebu(i,kts,j,p_ebu_pm25) = ebu_in(i,1,j,p_ebu_in_pm25)
-               ebu(i,kts,j,p_ebu_oc) = ebu_in(i,1,j,p_ebu_in_oc)
-               ebu(i,kts,j,p_ebu_bc) = ebu_in(i,1,j,p_ebu_in_bc)
-            enddo
+!            do i=its,ite
+               ebu(its:ite,kts,j,p_ebu_co)       = ebu_in(its:ite,1,j,p_ebu_in_co)
+               ebu(its:ite,kts,j,p_ebu_no)       = ebu_in(its:ite,1,j,p_ebu_in_no)
+               ebu(its:ite,kts,j,p_ebu_no2)      = ebu_in(its:ite,1,j,p_ebu_in_no2)
+               ebu(its:ite,kts,j,p_ebu_so2)      = ebu_in(its:ite,1,j,p_ebu_in_so2)
+               ebu(its:ite,kts,j,p_ebu_nh3)      = ebu_in(its:ite,1,j,p_ebu_in_nh3)
+               ebu(its:ite,kts,j,p_ebu_ch4)      = ebu_in(its:ite,1,j,p_ebu_in_ch4)
+               ebu(its:ite,kts,j,p_ebu_acet)     = ebu_in(its:ite,1,j,p_ebu_in_acet)
+               ebu(its:ite,kts,j,p_ebu_c2h6)     = ebu_in(its:ite,1,j,p_ebu_in_c2h6)
+               ebu(its:ite,kts,j,p_ebu_c3h8)     = ebu_in(its:ite,1,j,p_ebu_in_c3h8)
+               ebu(its:ite,kts,j,p_ebu_alk3)     = ebu_in(its:ite,1,j,p_ebu_in_alk3)
+               ebu(its:ite,kts,j,p_ebu_alk4)     = ebu_in(its:ite,1,j,p_ebu_in_alk4)
+               ebu(its:ite,kts,j,p_ebu_alk5)     = ebu_in(its:ite,1,j,p_ebu_in_alk5)
+               ebu(its:ite,kts,j,p_ebu_aro1)     = ebu_in(its:ite,1,j,p_ebu_in_aro1)
+               ebu(its:ite,kts,j,p_ebu_aro2)     = ebu_in(its:ite,1,j,p_ebu_in_aro2)
+               ebu(its:ite,kts,j,p_ebu_bald)     = ebu_in(its:ite,1,j,p_ebu_in_bald)
+               ebu(its:ite,kts,j,p_ebu_ccho)     = ebu_in(its:ite,1,j,p_ebu_in_ccho)
+               ebu(its:ite,kts,j,p_ebu_cco_oh)   = ebu_in(its:ite,1,j,p_ebu_in_cco_oh)
+               ebu(its:ite,kts,j,p_ebu_ethene)   = ebu_in(its:ite,1,j,p_ebu_in_ethene)
+               ebu(its:ite,kts,j,p_ebu_hcho)     = ebu_in(its:ite,1,j,p_ebu_in_hcho)
+               ebu(its:ite,kts,j,p_ebu_hcooh)    = ebu_in(its:ite,1,j,p_ebu_in_hcooh)
+               ebu(its:ite,kts,j,p_ebu_hono)     = ebu_in(its:ite,1,j,p_ebu_in_hono)
+               ebu(its:ite,kts,j,p_ebu_isoprene) = ebu_in(its:ite,1,j,p_ebu_in_isoprene)
+               ebu(its:ite,kts,j,p_ebu_mek)      = ebu_in(its:ite,1,j,p_ebu_in_mek)
+               ebu(its:ite,kts,j,p_ebu_meoh)     = ebu_in(its:ite,1,j,p_ebu_in_meoh)
+               ebu(its:ite,kts,j,p_ebu_methacro) = ebu_in(its:ite,1,j,p_ebu_in_methacro)
+               ebu(its:ite,kts,j,p_ebu_mgly)     = ebu_in(its:ite,1,j,p_ebu_in_mgly)
+               ebu(its:ite,kts,j,p_ebu_mvk)      = ebu_in(its:ite,1,j,p_ebu_in_mvk)
+               ebu(its:ite,kts,j,p_ebu_ole1)     = ebu_in(its:ite,1,j,p_ebu_in_ole1)
+               ebu(its:ite,kts,j,p_ebu_ole2)     = ebu_in(its:ite,1,j,p_ebu_in_ole2)
+               ebu(its:ite,kts,j,p_ebu_phen)     = ebu_in(its:ite,1,j,p_ebu_in_phen)
+               ebu(its:ite,kts,j,p_ebu_prod2)    = ebu_in(its:ite,1,j,p_ebu_in_prod2)
+               ebu(its:ite,kts,j,p_ebu_rcho)     = ebu_in(its:ite,1,j,p_ebu_in_rcho)
+               ebu(its:ite,kts,j,p_ebu_rno3)     = ebu_in(its:ite,1,j,p_ebu_in_rno3)
+               ebu(its:ite,kts,j,p_ebu_terp)     = ebu_in(its:ite,1,j,p_ebu_in_terp)
+               ebu(its:ite,kts,j,p_ebu_pm10)     = ebu_in(its:ite,1,j,p_ebu_in_pm10)
+               ebu(its:ite,kts,j,p_ebu_pm25)     = ebu_in(its:ite,1,j,p_ebu_in_pm25)
+               ebu(its:ite,kts,j,p_ebu_oc)       = ebu_in(its:ite,1,j,p_ebu_in_oc)
+               ebu(its:ite,kts,j,p_ebu_bc)       = ebu_in(its:ite,1,j,p_ebu_in_bc)
+!            enddo
          enddo
 !--lm
        elseif ( config_flags%biomass_burn_opt == BIOMASSB_GHG ) then
@@ -252,6 +259,62 @@ subroutine plumerise_driver (id,ktau,dtstep,                           &
                ebu(i,kts,j,p_ebu_ch4) = ebu_in(i,1,j,p_ebu_in_ch4)
             enddo
           enddo
+!lm Add a biomass burning emission package for CBMZ
+       elseif ( config_flags%biomass_burn_opt == BIOMASSB_CBMZ ) then
+         do j=jts,jte
+!           do i=its,ite
+             ebu(its:ite,kts,j,p_ebu_no)       = ebu_in(its:ite,1,j,p_ebu_in_no)
+             ebu(its:ite,kts,j,p_ebu_co)       = ebu_in(its:ite,1,j,p_ebu_in_co)
+             ebu(its:ite,kts,j,p_ebu_c2h4)     = ebu_in(its:ite,1,j,p_ebu_in_c2h4)
+             ebu(its:ite,kts,j,p_ebu_c2h5oh)   = ebu_in(its:ite,1,j,p_ebu_in_c2h5oh)
+             ebu(its:ite,kts,j,p_ebu_c2h6)     = ebu_in(its:ite,1,j,p_ebu_in_c2h6)
+             ebu(its:ite,kts,j,p_ebu_c3h6)     = ebu_in(its:ite,1,j,p_ebu_in_c3h6)
+             ebu(its:ite,kts,j,p_ebu_c3h8)     = ebu_in(its:ite,1,j,p_ebu_in_c3h8)
+             ebu(its:ite,kts,j,p_ebu_ch2o)     = ebu_in(its:ite,1,j,p_ebu_in_ch2o)
+             ebu(its:ite,kts,j,p_ebu_ch3cho)   = ebu_in(its:ite,1,j,p_ebu_in_ch3cho)
+             ebu(its:ite,kts,j,p_ebu_ch3coch3) = ebu_in(its:ite,1,j,p_ebu_in_ch3coch3)
+             ebu(its:ite,kts,j,p_ebu_ch3oh)    = ebu_in(its:ite,1,j,p_ebu_in_ch3oh)
+             ebu(its:ite,kts,j,p_ebu_mek)      = ebu_in(its:ite,1,j,p_ebu_in_mek)
+             ebu(its:ite,kts,j,p_ebu_so2)      = ebu_in(its:ite,1,j,p_ebu_in_so2)
+             ebu(its:ite,kts,j,p_ebu_toluene)  = ebu_in(its:ite,1,j,p_ebu_in_toluene)
+             ebu(its:ite,kts,j,p_ebu_nh3)      = ebu_in(its:ite,1,j,p_ebu_in_nh3)
+             ebu(its:ite,kts,j,p_ebu_no2)      = ebu_in(its:ite,1,j,p_ebu_in_no2)
+             ebu(its:ite,kts,j,p_ebu_open)     = ebu_in(its:ite,1,j,p_ebu_in_open)
+             ebu(its:ite,kts,j,p_ebu_c10h16)   = ebu_in(its:ite,1,j,p_ebu_in_c10h16)
+             ebu(its:ite,kts,j,p_ebu_mgly)     = ebu_in(its:ite,1,j,p_ebu_in_mgly)
+             ebu(its:ite,kts,j,p_ebu_ch3cooh)  = ebu_in(its:ite,1,j,p_ebu_in_ch3cooh)
+             ebu(its:ite,kts,j,p_ebu_glyald)   = ebu_in(its:ite,1,j,p_ebu_in_glyald)
+             ebu(its:ite,kts,j,p_ebu_gly)      = ebu_in(its:ite,1,j,p_ebu_in_gly)
+             ebu(its:ite,kts,j,p_ebu_acetol)   = ebu_in(its:ite,1,j,p_ebu_in_acetol)
+             ebu(its:ite,kts,j,p_ebu_isop)     = ebu_in(its:ite,1,j,p_ebu_in_isop)
+             ebu(its:ite,kts,j,p_ebu_macr)     = ebu_in(its:ite,1,j,p_ebu_in_macr)
+             ebu(its:ite,kts,j,p_ebu_mvk)      = ebu_in(its:ite,1,j,p_ebu_in_mvk)
+             ebu(its:ite,kts,j,p_ebu_ol2)      = ebu_in(its:ite,1,j,p_ebu_in_ol2)
+             ebu(its:ite,kts,j,p_ebu_par)      = ebu_in(its:ite,1,j,p_ebu_in_par)
+             ebu(its:ite,kts,j,p_ebu_eth)      = ebu_in(its:ite,1,j,p_ebu_in_eth)
+             ebu(its:ite,kts,j,p_ebu_olt)      = ebu_in(its:ite,1,j,p_ebu_in_olt)
+             ebu(its:ite,kts,j,p_ebu_oli)      = ebu_in(its:ite,1,j,p_ebu_in_oli)
+             ebu(its:ite,kts,j,p_ebu_iso)      = ebu_in(its:ite,1,j,p_ebu_in_iso)
+             ebu(its:ite,kts,j,p_ebu_tol)      = ebu_in(its:ite,1,j,p_ebu_in_tol)
+             ebu(its:ite,kts,j,p_ebu_csl)      = ebu_in(its:ite,1,j,p_ebu_in_csl)
+             ebu(its:ite,kts,j,p_ebu_hcho)     = ebu_in(its:ite,1,j,p_ebu_in_hcho)
+             ebu(its:ite,kts,j,p_ebu_ald)      = ebu_in(its:ite,1,j,p_ebu_in_ald)
+             ebu(its:ite,kts,j,p_ebu_ket)      = ebu_in(its:ite,1,j,p_ebu_in_ket)
+             ebu(its:ite,kts,j,p_ebu_xyl)      = ebu_in(its:ite,1,j,p_ebu_in_xyl)
+             ebu(its:ite,kts,j,p_ebu_ora1)     = ebu_in(its:ite,1,j,p_ebu_in_ora1)
+             ebu(its:ite,kts,j,p_ebu_ora2)     = ebu_in(its:ite,1,j,p_ebu_in_ora2)
+             ebu(its:ite,kts,j,p_ebu_co2)      = ebu_in(its:ite,1,j,p_ebu_in_co2)
+             ebu(its:ite,kts,j,p_ebu_ete)      = ebu_in(its:ite,1,j,p_ebu_in_ete)
+             ebu(its:ite,kts,j,p_ebu_dien)     = ebu_in(its:ite,1,j,p_ebu_in_dien)
+             ebu(its:ite,kts,j,p_ebu_api)      = ebu_in(its:ite,1,j,p_ebu_in_api)
+             ebu(its:ite,kts,j,p_ebu_lim)      = ebu_in(its:ite,1,j,p_ebu_in_lim)
+             ebu(its:ite,kts,j,p_ebu_pm10)     = ebu_in(its:ite,1,j,p_ebu_in_pm10)
+             ebu(its:ite,kts,j,p_ebu_pm25)     = ebu_in(its:ite,1,j,p_ebu_in_pm25)
+             ebu(its:ite,kts,j,p_ebu_oc)       = ebu_in(its:ite,1,j,p_ebu_in_oc)
+             ebu(its:ite,kts,j,p_ebu_bc)       = ebu_in(its:ite,1,j,p_ebu_in_bc)
+!           enddo
+         enddo
+!lm
        endif
 !
        do nv=1,num_ebu
@@ -264,16 +327,25 @@ subroutine plumerise_driver (id,ktau,dtstep,                           &
           enddo
        enddo
        
+!lm switch to turn off the plumerise, should be in the namelist
+!TO2    ifplumerise = 1
+!TO2    if(ifplumerise == 1) then
+    if(config_flags%ifplumerise == 1) then
+!TO2   
+!lm       
        do j=jts,jte
           do i=its,ite
-            sum=mean_fct_agtf(i,j)+mean_fct_agef(i,j)+mean_fct_agsv(i,j)    &
+!lm I changed the variable name from sum to sum_fires because sum is
+! a Fortran function 
+            sum_fires=mean_fct_agtf(i,j)+mean_fct_agef(i,j)+mean_fct_agsv(i,j)    &
                     +mean_fct_aggr(i,j)
-            if(sum.lt.1.e-6)Cycle
-!           write(0,*)'before',i,j,ebu_co(i,1,j),sum
+            if(sum_fires.lt.1.e-6)Cycle
+!           write(0,*)'before',i,j,ebu_co(i,1,j),sum_fires
 !           ffirs=ffirs+1
-            sum=firesize_agtf(i,j)+firesize_agef(i,j)+firesize_agsv(i,j)    &
+            sum_fires=firesize_agtf(i,j)+firesize_agef(i,j)+firesize_agsv(i,j)    &
                     +firesize_aggr(i,j)
-            if(sum.lt.1.e-6)Cycle
+            if(sum_fires.lt.1.e-6)Cycle
+!lm
             eburn_out=0.
             mean_fct(1)=mean_fct_agtf(i,j)
             mean_fct(2)=mean_fct_agef(i,j)
@@ -352,12 +424,15 @@ is_mozcart : &
 ! we input total emissions instead of smoldering emissions:
 ! ratio of smolderling to total
 !-------------------------------------------------------------------
-                sum = 0.
+!lm I changed the variable name from sum to sum_fires because sum is
+! a Fortran function
+                sum_fires = 0.
                 do k = kts,kte
-                  sum = sum + ebu(i,k,j,p_ebu_co)
+                  sum_fires = sum_fires + ebu(i,k,j,p_ebu_co)
                 end do
-                if( sum > 0. ) then             
-                  ratio = ebu(i,kts,j,p_ebu_co)/sum
+                if( sum_fires > 0. ) then             
+                  ratio = ebu(i,kts,j,p_ebu_co)/sum_fires
+!lm
                 else
                   ratio = 0.
                 endif
@@ -422,15 +497,17 @@ is_mozcart : &
 ! we input total emissions instead of smoldering emissions:
 ! ratio of smolderling to total
 !-------------------------------------------------------------------
-                 sum = 0.
+!lm
+                 sum_fires = 0.
                  do k = kts,kte
-                   sum = sum + ebu(i,k,j,p_ebu_co)
+                   sum_fires = sum_fires + ebu(i,k,j,p_ebu_co)
                  end do
-                 if( sum > 0. ) then
-                   ratio = ebu(i,kts,j,p_ebu_co)/sum
+                 if( sum_fires > 0. ) then
+                   ratio = ebu(i,kts,j,p_ebu_co)/sum_fires
                  else
                    ratio = 0.
                  endif
+!lm
  
                  do k = kts,kte
                    ebu(i,k,j,p_ebu_no)  = ebu(i,k,j,p_ebu_no)*ratio
@@ -470,6 +547,9 @@ is_mozcart : &
 
           enddo
           enddo
+!lm
+    endif !config_flags%ifplumerise == 1
+!lm
 end subroutine plumerise_driver
 
 END Module module_plumerise1
-- 
2.31.1

